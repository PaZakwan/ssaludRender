"use strict";(self["webpackChunksecretaria_de_salud_moreno_frontend"]=self["webpackChunksecretaria_de_salud_moreno_frontend"]||[]).push([[482],{8593:function(a,t,e){e.d(t,{Z:function(){return D}});var i=e(7416),r=e(6194),o=e(8956),s=e(2353),l=e(6530),n=e(5049),c=e(683),d=e(445),u=e(3667),m=e(9456),g=e(8143),p=e(4920),h=e(4618),f=e(5730),b=function(){var a=this,t=a._self._c;return t(n.Z,{attrs:{"max-width":"80%",persistent:"",scrollable:""},model:{value:a.dialogTransferencia.state,callback:function(t){a.$set(a.dialogTransferencia,"state",t)},expression:"dialogTransferencia.state"}},[t(o.Z,[t(p.Z,{attrs:{color:"grey lighten-2",height:"auto",window:""}},[t(u.Z,{attrs:{medium:"",color:"black darken-2"}},[a._v("input")]),t("span",{staticClass:"display-1 font-weight-bold text-capitalize black--text text--darken-2"},[a._v(a._s(a.dialogTransferencia.remito?`Remito: ${a.dataEdit.remito}`:"Nueva Transferencia"))]),t(g.Cl),t(u.Z,{attrs:{large:"",disabled:a.loading.estado,color:"error darken-1"},on:{click:a.close}},[a._v("cancel_presentation")])],1),t(s.ZB,[t(d.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:a.valido,callback:function(t){a.valido=t},expression:"valido"}},[t(l.Z,{attrs:{"grid-list-md":""}},[t(m.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{soloLectura:a.dialogTransferencia.soloLectura,clearable:!a.dialogTransferencia.soloLectura,color:"primary",label:"Fecha Emision",icon:"event",value:a.dataEdit.fecha,max:a.hoy,requerido:"true"},model:{value:a.dataEdit.fecha,callback:function(t){a.$set(a.dataEdit,"fecha",t)},expression:"dataEdit.fecha"}})],1),t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(h.h,{attrs:{readonly:"","background-color":"primary lighten-1","prepend-icon":"list_alt",placeholder:"El Numero de remito sera autogenerado una vez guardada la transferencia.",hint:"El Numero de remito sera autogenerado una vez guardada la transferencia.",label:"Remito",type:"text",color:"primary"},model:{value:a.dataEdit.remito,callback:function(t){a.$set(a.dataEdit,"remito",t)},expression:"dataEdit.remito"}})],1),t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(i.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogTransferencia.soloLectura,clearable:!a.dialogTransferencia.soloLectura,"background-color":a.dialogTransferencia.soloLectura?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Origen","prepend-icon":"local_shipping",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.origen,callback:function(t){a.$set(a.dataEdit,"origen",t)},expression:"dataEdit.origen"}})],1),t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(i.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogTransferencia.soloLectura,clearable:!a.dialogTransferencia.soloLectura,"background-color":a.dialogTransferencia.soloLectura?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"area",items:a.areasDestino,label:"Destino","prepend-icon":"fa-house-medical-flag",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},on:{"click:clear":function(t){a.$nextTick((()=>a.dataEdit.destino=""))}},model:{value:a.dataEdit.destino,callback:function(t){a.$set(a.dataEdit,"destino",t)},expression:"dataEdit.destino"}})],1),t(c.Z,{attrs:{"hidden-xs-only":"",sm3:"","px-3":""}}),t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{soloLectura:a.dialogTransferencia.soloLectura,clearable:!a.dialogTransferencia.soloLectura,color:"primary",label:"Fecha Planificada (Opcional)",icon:"event",value:a.dataEdit.fec_planificada,min:a.hoy},model:{value:a.dataEdit.fec_planificada,callback:function(t){a.$set(a.dataEdit,"fec_planificada",t)},expression:"dataEdit.fec_planificada"}})],1),t(c.Z,{attrs:{"hidden-xs-only":"",sm3:"","px-3":""}}),t(c.Z,{attrs:{xs12:"","px-3":"",primary:"","darken-3":""}},[t("h4",{staticClass:"title float: left white--text"},[a._v("Insumos a Transferir")])]),a._l(a.dataEdit.insumos,(function(e,i){return t(c.Z,{key:`insumos-${i}`,attrs:{xs12:""}},[t("componentEgresoInsumo",{attrs:{egreso:e,index:i,stockDB:a.stockFiltrado,agregarFila:a.agregarFila,borrarFila:a.borrarFila,actualizar:a.actualizarStockFiltrado,noGestionEnOrigen:a.noGestionEnOrigen}})],1)})),t(c.Z,{attrs:{xs12:"","mx-3":""}},[t(f.Z,{attrs:{readonly:a.dialogTransferencia.soloLectura,clearable:!a.dialogTransferencia.soloLectura,"background-color":a.dialogTransferencia.soloLectura?"primary lighten-1":"primary lighten-5",label:"Observacion (opcional)",color:"primary","prepend-icon":"description","auto-grow":"",rows:"2"},model:{value:a.dataEdit.observacion,callback:function(t){a.$set(a.dataEdit,"observacion",t)},expression:"dataEdit.observacion"}})],1),a.dialogTransferencia.soloLectura?t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(h.h,{attrs:{readonly:"","background-color":"primary lighten-1","prepend-icon":"local_shipping",label:"Fecha Retirado de Origen",placeholder:"Sin Retirar",type:"text",color:"primary"},model:{value:a.dataEdit.retirado,callback:function(t){a.$set(a.dataEdit,"retirado",t)},expression:"dataEdit.retirado"}})],1):a._e(),a.dialogTransferencia.soloLectura?t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(h.h,{attrs:{readonly:"","background-color":"primary lighten-1","prepend-icon":"local_shipping",label:"Fecha Recibido en Destino",placeholder:"Sin Recibir",type:"text",color:"primary"},model:{value:a.dataEdit.recibido,callback:function(t){a.$set(a.dataEdit,"recibido",t)},expression:"dataEdit.recibido"}})],1):a._e()],2)],1)],1)],1),t(s.h7,[t(m.Z,{attrs:{row:"",wrap:""}},[t(r.Z,a._g({attrs:{disabled:a.loading.estado||!!a.dataEdit.retirado||a.noGestionEnOrigen,round:"",color:"primary"},on:{click:function(t){return a.agregarFila()}}},a.on),[t(u.Z,{attrs:{large:"",left:""}},[a._v("control_point")]),a._v("Insumo Transf. ")],1),t(g.Cl),t(r.Z,{staticClass:"error darken-1",attrs:{disabled:a.loading.estado,round:"",loading:a.loading.estado},on:{click:a.close}},[a._v(" Cancelar ")]),t(r.Z,{staticClass:"primary darken-1 white--text",attrs:{disabled:a.loading.estado||!!a.dataEdit.retirado||a.noGestionEnOrigen,loading:a.loading.estado,round:""},on:{click:function(t){return a.guardarTransferencia({transferencia:a.dataEdit,validate:a.$refs.form.validate,finish:a.close})}}},[a._v(" "+a._s(a.valido?a.dialogTransferencia.remito?"Guardar Cambios":"Crear Transf.":"Formulario No valido")+" ")])],1)],1)],1)],1)},v=[],x=e(629),y=e(5967),_=e(7698),k={name:"dialogTransferencia",props:["closeFinish"],components:{dateSelect:y.Z,componentEgresoInsumo:_.Z},data:()=>({valido:!0,noGestionEnOrigen:!1,areasDB:[],areasFiltro:[],areasDestino:[],stockEntregaDB:[],stockFiltrado:[],dataEdit:{},dataEditBase:{fecha:"",remito:"",origen:"",destino:"",insumos:[{insumo:void 0,cantidad:null}],observacion:"",fec_planificada:"",retirado:"",recibido:""}}),computed:{...(0,x.rn)(["loading","hoy","persona","rules"]),...(0,x.rn)("farmacia",["dialogTransferencia"])},watch:{async"dialogTransferencia.state"(a){a?(this.areasDB.push(...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})),this.areasDestino=this.areasDB,this.areasFiltro=this.persona.farmacia?.general?.admin?this.areasDB:await this.filtrarArrayParaSelectsDisabled({arraySelects:this.areasDB,arrayEnable:this.persona.farmacia?.gestion,propCompare:"_id"}),this.dialogTransferencia.remito&&(this.dataEdit=Object.assign(this._cloneDeep(this.dataEditBase),this._cloneDeep(this.dialogTransferencia.remito))),this.persona.farmacia.general?.admin||!this.dataEdit.origen||this.persona.farmacia.gestion?.includes(this.dataEdit.origen)||(this.noGestionEnOrigen=!0)):(this.dataEdit=this._cloneDeep(this.dataEditBase),this.noGestionEnOrigen=!1),this.$refs.form.resetValidation()},async"dataEdit.origen"(a,t){if(a){if(this.stockEntregaDB=await this.buscarStockParaEntregas({area:a}),this.dataEdit.destino===a&&(this.dataEdit.destino=""),t&&(this.dataEdit.insumos=[{...this.dataEditBase.insumos[0]}]),this.dialogTransferencia.remito&&this.dataEdit.insumos[0].insumo)for(let e=0;e<this.dataEdit.insumos.length;e++){let a=this.stockEntregaDB.find((a=>a._id===this.dataEdit.insumos[e].stockID));this.$set(this.dataEdit.insumos,e,{...this.dataEdit.insumos[e],insumo:a||{_id:this.dataEdit.insumos[e].stockID,insumo:this.dataEdit.insumos[e].insumo,insumoDB:this.dataEdit.insumos[e].insumoDB,procedencia:this.dataEdit.insumos[e].procedencia,lote:this.dataEdit.insumos[e].lote,vencimiento:this.dataEdit.insumos[e].vencimiento,cantidad:0}})}}else this.stockEntregaDB=[],this.dataEdit.insumos=[{...this.dataEditBase.insumos[0]}];this.areasDestino=await this.filtrarArrayParaSelectsDisabled({arraySelects:this.areasDB,arrayDisable:[a],propCompare:"_id"}),this.actualizarStockFiltrado()}},beforeMount(){this.dataEditBase.fecha=this.hoy,this.dataEdit=this._cloneDeep(this.dataEditBase)},methods:{...(0,x.nv)("main_areas",["buscarAreaFiltros"]),...(0,x.nv)(["filtrarArrayParaSelectsDisabled"]),...(0,x.nv)("farmacia",["actualizarDialogIngresoTransferencia","buscarStockParaEntregas","guardarTransferencia"]),close(){this.actualizarDialogIngresoTransferencia({state:!1,type:{transferencia:!0}}),this.closeFinish()},async actualizarStockFiltrado(){let a=[];this.dataEdit.insumos.forEach((t=>{t.insumo?._id&&a.push(t.insumo._id)})),a.length>0?this.stockFiltrado=await this.filtrarArrayParaSelectsDisabled({arraySelects:this.stockEntregaDB,arrayDisable:a,propCompare:"_id"}):this.stockFiltrado=this.stockEntregaDB},agregarFila(){this.dataEdit.insumos.push({...this.dataEditBase.insumos[0]})},borrarFila(a){this.dataEdit.insumos.splice(a,1),this.actualizarStockFiltrado()}}},Z=k,E=e(1001),w=(0,E.Z)(Z,b,v,!1,null,null,null),D=w.exports},931:function(a,t,e){e.r(t),e.d(t,{default:function(){return P}});var i=e(8469),r=e(7416),o=e(6194),s=e(8956),l=e(2353),n=e(9418),c=e(6530),d=e(7352),u=e(108),m=e(683),g=e(3667),p=e(9456),h=e(6446),f=e(8143),b=e(4618),v=function(){var a=this,t=a._self._c;return t(c.Z,{attrs:{fluid:"","grid-list-xs":""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(s.Z,{staticClass:"white--text",attrs:{color:"cuarto darken-2"}},[t(l.ZB,{staticClass:"px-0 text-uppercase"},[a._v("====== Gestion de Farmacia ======")])],1)],1)],1),t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",cuarto:"","darken-1":""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("medication")]),t("span",{staticClass:"title white--text"},[a._v("Farmacia / Egresos")])],1),t(f.Cl),t(o.Z,{attrs:{fab:"",small:"",color:"primary darken-2"},on:{click:function(t){return a.retroceder()}}},[t(g.Z,[a._v("far fa-arrow-alt-circle-left")])],1)],1),t(s.Z,{staticClass:"elevation-6",attrs:{color:"grey lighten-2"}},[t(l.ZB,{staticClass:"px-0"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{xs12:"","px-3":""}},[t(s.Z,{staticClass:"grey lighten-3"},[t(p.Z,{attrs:{"justify-center":"",row:"",wrap:""},on:{keypress:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.recargarDataTable(a.filtro)}}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.desde,"background-color":"cuarto lighten-5",color:"cuarto",label:"Desde",icon:"today",max:a.filtro.hasta,requerido:"true"},model:{value:a.filtro.desde,callback:function(t){a.$set(a.filtro,"desde",t)},expression:"filtro.desde"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.hasta,"background-color":"cuarto lighten-5",color:"cuarto",label:"Hasta",icon:"event",min:a.filtro.desde,requerido:"true"},model:{value:a.filtro.hasta,callback:function(t){a.$set(a.filtro,"hasta",t)},expression:"filtro.hasta"}})],1),t(m.Z,{attrs:{xs12:"",sm9:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{clearable:"","background-color":"cuarto lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Farmacia","prepend-icon":"fa-house-medical-flag",color:"cuarto",multiple:"",chips:"","deletable-chips":""},on:{"click:clear":function(t){a.$nextTick((()=>a.filtro.areas=[]))}},model:{value:a.filtro.areas,callback:function(t){a.$set(a.filtro,"areas",t)},expression:"filtro.areas"}})],1),t(m.Z,{attrs:{xs12:"",sm9:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{clearable:"","background-color":"cuarto lighten-5","item-value":"id","item-text":"nombreC",items:a.insumosDB,label:"Insumos (Opcional)","prepend-icon":"fa-solid fa-pills",color:"cuarto",multiple:"",chips:"","deletable-chips":""},on:{"click:clear":function(t){a.$nextTick((()=>a.filtro.insumos=[]))}},model:{value:a.filtro.insumos,callback:function(t){a.$set(a.filtro,"insumos",t)},expression:"filtro.insumos"}})],1)],1),t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[t(o.Z,{staticClass:"white--text mb-2",attrs:{round:"",color:"cuarto darken-2",disabled:a.loading.estado,loading:a.loading.estado},on:{click:function(t){return a.recargarDataTable(a.filtro)}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("search")]),a._v(" Buscar Egresos")],1),t(u.Z,{staticClass:"hidden-xs-only mx-4 my-1 black",attrs:{vertical:""}}),t(o.Z,{staticClass:"white--text mb-2",attrs:{round:"",color:"cuarto darken-2",disabled:a.loading.estado,loading:a.loading.estado},on:{click:function(t){return a.reporte()}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("fa-solid fa-file-pdf")]),a._v(" Egresos PDF")],1)],1)],1)],1)],1)],1)],1)],1),t(m.Z,{attrs:{"pa-1":"","ma-1":"",xs12:"",cuarto:"","lighten-1":""}},[t(s.Z,{staticClass:"elevation-6"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",primary:""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("output")]),t("span",{staticClass:"title white--text"},[a._v("Egresos de Insumos")])],1),t(f.Cl)],1),t(n.Z,[t(m.Z,{attrs:{xs12:"",sm4:"","px-2":""}},[t(b.h,{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":"",clearable:""},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1),t(f.Cl),t(u.Z,{staticClass:"hidden-xs-only mx-2 primary",attrs:{inset:"",vertical:""}}),t(o.Z,{staticClass:"mb-2",attrs:{round:"",color:"primary",disabled:a.loading.estado||!(a.persona.farmacia.gestion?.length>0||a.persona.farmacia.general?.admin),loading:a.loading.estado},on:{click:function(t){return a.actualizarDialogDescarte({state:!0})}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("output")]),a._v(" Nuevo Egreso")],1)],1),t(d.Z,{staticClass:"elevation-6",staticStyle:{"table-layout":"fixed"},attrs:{id:"tablita",headers:a.headers,items:a.dataTable,"item-key":"_id",pagination:a.paginacion,loading:a.loading.estado,search:a.search},on:{"update:pagination":function(t){a.paginacion=t}},scopedSlots:a._u([{key:"no-results",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(' No se encontraron resultados para "'+a._s(a.search)+'". ')])]},proxy:!0},{key:"no-data",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(" No hay datos para mostrar. ")])]},proxy:!0},{key:"items",fn:function(e){return[t("tr",{class:a.backgroundClass(e.item)},a._l(a.headersDinamics,(function(a){return t("td",{key:a.text,class:a.class},[t("bodyDataTableDinamic",{attrs:{props:e,field:a}})],1)})),0)]}}])},[t(h.Z,{attrs:{color:"blue",indeterminate:""}})],1)],1)],1)],1),t("dialogDescarte",{attrs:{closeFinish:a.recargarDataTable}})],1)},x=[],y=e(629),_=e(5967),k=e(5167),Z=e(5049),E=e(445),w=e(4920),D=function(){var a=this,t=a._self._c;return t(Z.Z,{attrs:{"max-width":"80%",persistent:"",scrollable:""},model:{value:a.dialogDescarte.state,callback:function(t){a.$set(a.dialogDescarte,"state",t)},expression:"dialogDescarte.state"}},[t(s.Z,[t(w.Z,{attrs:{color:"grey lighten-2",height:"auto",window:""}},[t(g.Z,{attrs:{medium:"",color:"black darken-2"}},[a._v("output")]),t("span",{staticClass:"display-1 font-weight-bold text-capitalize black--text text--darken-2"},[a._v(a._s(a.dialogDescarte.descarte?"Insumo Descartado":"Nuevo Egreso"))]),t(f.Cl),t(g.Z,{attrs:{large:"",disabled:a.loading.estado,color:"error darken-1"},on:{click:a.close}},[a._v("cancel_presentation")])],1),t(l.ZB,[t(E.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:a.valido,callback:function(t){a.valido=t},expression:"valido"}},[t(c.Z,{attrs:{"grid-list-md":""}},[t(p.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{soloLectura:a.dialogDescarte.soloLectura,clearable:!a.dialogDescarte.soloLectura,color:"primary",label:"Fecha",icon:"event",value:a.dataEdit.fecha,max:a.hoy,requerido:"true"},model:{value:a.dataEdit.fecha,callback:function(t){a.$set(a.dataEdit,"fecha",t)},expression:"dataEdit.fecha"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogDescarte.soloLectura,clearable:!a.dialogDescarte.soloLectura,"background-color":a.dialogDescarte.soloLectura?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Origen","prepend-icon":"fa-house-medical-flag",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.origen,callback:function(t){a.$set(a.dataEdit,"origen",t)},expression:"dataEdit.origen"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogDescarte.soloLectura,clearable:!a.dialogDescarte.soloLectura,"background-color":a.dialogDescarte.soloLectura?"primary lighten-1":"primary lighten-5",items:a.descarteMotivos,label:"Motivo","prepend-icon":"description",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.motivo,callback:function(t){a.$set(a.dataEdit,"motivo",t)},expression:"dataEdit.motivo"}})],1),t(m.Z,{attrs:{xs12:"","px-3":"",primary:"","darken-3":""}},[t("h4",{staticClass:"title float: left white--text"},[a._v("Insumos a Egresar")])]),a._l(a.dataEdit.insumos,(function(e,i){return t(m.Z,{key:`insumos-${i}`,attrs:{xs12:""}},[t("componentEgresoInsumo",{attrs:{egreso:e,index:i,stockDB:a.stockFiltrado,agregarFila:a.agregarFila,borrarFila:a.borrarFila,actualizar:a.actualizarStockFiltrado,noGestionEnOrigen:!1}})],1)})),a.dialogDescarte.soloLectura?t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(b.h,{attrs:{readonly:"","background-color":"primary lighten-1","prepend-icon":"local_shipping",label:"Fecha de Retirado",placeholder:"Sin Salir",type:"text",color:"primary"},model:{value:a.dataEdit.retirado,callback:function(t){a.$set(a.dataEdit,"retirado",t)},expression:"dataEdit.retirado"}})],1):a._e()],2)],1)],1)],1),t(l.h7,[t(p.Z,{attrs:{row:"",wrap:""}},[t(o.Z,a._g({attrs:{disabled:a.loading.estado||a.dialogDescarte.soloLectura,round:"",color:"primary"},on:{click:function(t){return a.agregarFila()}}},a.on),[t(g.Z,{attrs:{large:"",left:""}},[a._v("control_point")]),a._v("Insumo Egresar ")],1),t(f.Cl),t(o.Z,{staticClass:"error darken-1",attrs:{disabled:a.loading.estado,round:"",loading:a.loading.estado},on:{click:a.close}},[a._v(" Cancelar ")]),t(o.Z,{staticClass:"primary darken-1 white--text",attrs:{disabled:a.loading.estado||a.dialogDescarte.soloLectura,loading:a.loading.estado,round:""},on:{click:function(t){return a.guardarDescarte({descarte:a.dataEdit,validate:a.$refs.form.validate,finish:a.close})}}},[a._v(" "+a._s(a.valido?a.dialogDescarte.descarte?"Guardar Cambios":"Realizar Egreso":"Formulario No valido")+" ")])],1)],1)],1)],1)},C=[],S=e(7698),F={name:"dialogDescarte",props:["closeFinish"],components:{dateSelect:_.Z,componentEgresoInsumo:S.Z},data:()=>({valido:!0,areasFiltro:[],stockEntregaDB:[],stockFiltrado:[],dataEdit:{},dataEditBase:{fecha:"",origen:"",motivo:"",insumos:[{insumo:void 0,cantidad:null}],retirado:""}}),computed:{...(0,y.rn)(["loading","hoy","persona","rules"]),...(0,y.rn)("farmacia",["dialogDescarte","descarteMotivos"])},watch:{async"dialogDescarte.state"(a){if(a){this.dataEdit=this._cloneDeep(this.dataEditBase);let a=[...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})];this.areasFiltro=this.persona.farmacia?.general?.admin?a:await this.filtrarArrayParaSelectsDisabled({arraySelects:a,arrayEnable:this.persona.farmacia?.gestion,propCompare:"_id"})}else this.dataEdit=this._cloneDeep(this.dataEditBase);this.$refs.form.resetValidation()},async"dataEdit.origen"(a){this.stockEntregaDB=a?await this.buscarStockParaEntregas({area:a}):[],this.dataEdit.insumos=[{...this.dataEditBase.insumos[0]}],this.actualizarStockFiltrado()}},beforeMount(){this.dataEditBase.fecha=this.hoy,this.dataEdit=this._cloneDeep(this.dataEditBase)},methods:{...(0,y.nv)(["filtrarArrayParaSelectsDisabled"]),...(0,y.nv)("main_areas",["buscarAreaFiltros"]),...(0,y.nv)("farmacia",["actualizarDialogDescarte","buscarStockParaEntregas","guardarDescarte"]),close(){this.actualizarDialogDescarte({state:!1}),this.closeFinish()},async actualizarStockFiltrado(){let a=[];this.dataEdit.insumos.forEach((t=>{t.insumo?._id&&a.push(t.insumo._id)})),a.length>0?this.stockFiltrado=await this.filtrarArrayParaSelectsDisabled({arraySelects:this.stockEntregaDB,arrayDisable:a,propCompare:"_id"}):this.stockFiltrado=this.stockEntregaDB},agregarFila(){this.dataEdit.insumos.push({...this.dataEditBase.insumos[0]})},borrarFila(a){this.dataEdit.insumos.splice(a,1),this.actualizarStockFiltrado()}}},T=F,B=e(1001),I=(0,B.Z)(T,D,C,!1,null,null,null),z=I.exports,$={name:"farmaciaDescarteBuscar",components:{dateSelect:_.Z,bodyDataTableDinamic:k.Z,dialogDescarte:z},data:()=>({insumosDB:[],areasFiltro:[],dataTable:[],filtro:{desde:(new Date).getFullYear()-1+"-"+((new Date).getMonth()+1).toString().padStart(2,0)+"-01",hasta:"",areas:[],insumos:[]},ultimoFiltro:{},search:"",paginacion:{sortBy:"fecha",descending:!0,page:1,rowsPerPage:10},headers:[{text:"Fecha",value:"fecha",align:"left",class:"text-xs-left",width:"15%",ruta:"fecha",date:!0},{text:"Origen",value:"origenDB",align:"left",class:"text-capitalize text-xs-left",width:"15%",ruta:"origenDB"},{text:"Categoria Ins.",value:"categoriaDB",align:"left",class:"text-xs-left",width:"10%",ruta:"categoriaDB"},{text:"Insumo",value:"insumoDB",align:"left",class:"text-capitalize text-xs-left",width:"10%",ruta:"insumoDB"},{text:"Cantidad",value:"cantidad",align:"left",class:"text-xs-right",width:"10%",ruta:"cantidad"},{text:"Motivo",value:"motivo",align:"left",class:"text-capitalize text-xs-left",ruta:"motivo"},{text:"Procedencia",value:"procedencia",align:"left",class:"text-xs-left",width:"10%",ruta:"procedencia"},{text:"Lote",value:"lote",align:"left",class:"text-xs-right",width:"10%",ruta:"lote"},{text:"Vencimiento",value:"vencimiento",align:"left",class:"text-xs-left",width:"10%",ruta:"vencimiento",date:!0}]}),computed:{...(0,y.rn)(["loading","hoy","persona"]),headersDinamics(){return[...this.headers.filter((a=>!0!==a.ignore))]}},async created(){this.filtro.hasta=this.hoy;let a=[...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})];this.insumosDB=await this.buscarInsumosFiltro({select:"nombre descripcion nombreC"}),this.persona.farmacia.general?.reportes||this.persona.farmacia.general?.admin?(this.areasFiltro=a,this.filtro.areas=a.map((a=>a.id))):(this.areasFiltro=await this.filtrarArrayParaSelectsDisabled({arraySelects:a,arrayEnable:this.persona.farmacia.gestion,propCompare:"_id"}),this.filtro.areas=[...this.persona.farmacia.gestion]),await this.recargarDataTable(this.filtro)},methods:{...(0,y.OI)(["mostrarError","mostrarDialogIframe"]),...(0,y.nv)(["retroceder","routerResolve","filtrarArrayParaSelectsDisabled"]),...(0,y.nv)("main_areas",["buscarAreaFiltros"]),...(0,y.nv)("farmacia",["actualizarDialogDescarte","buscarInsumosFiltro","buscarDescartesFiltro"]),backgroundClass(a){if(!a)return"";try{return a.retirado?"background-color: green lighten-5":"background-color: orange lighten-4"}catch(t){return""}},async recargarDataTable(a){if(a){let t=await this.buscarDescartesFiltro(a);t&&(this.dataTable=t,this.ultimoFiltro=this._cloneDeep(a))}else this.dataTable=await this.buscarDescartesFiltro(this.ultimoFiltro)},async reporte(){if(this.filtro.areas.length>0){localStorage.setItem("pdfTemp",JSON.stringify(this.filtro));let a=await this.routerResolve({name:"FarmaciaDescarteImprimir",query:{descarga:!1}});this.mostrarDialogIframe({src:a.href,titulo_name:`Farmacia Egresos ${this.filtro.desde} ~ ${this.filtro.hasta}`})}else this.mostrarError({errores:"",mensaje:"Complete por lo menos con una Farmacia para el reporte.",titulo:"Valores Requeridos."})}}},L=$,A=(0,B.Z)(L,v,x,!1,null,null,null),P=A.exports},7914:function(a,t,e){e.r(t),e.d(t,{default:function(){return j}});var i=e(8469),r=e(7416),o=e(6194),s=e(8956),l=e(2353),n=e(9418),c=e(6530),d=e(7352),u=e(108),m=e(683),g=e(3667),p=e(9456),h=e(6446),f=e(8143),b=e(4618),v=e(1415),x=function(){var a=this,t=a._self._c;return t(c.Z,{attrs:{fluid:"","grid-list-xs":""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(s.Z,{staticClass:"white--text",attrs:{color:"cuarto darken-2"}},[t(l.ZB,{staticClass:"px-0 text-uppercase"},[a._v("====== Gestion de Farmacia ======")])],1)],1)],1),t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",cuarto:"","darken-1":""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("medication")]),t("span",{staticClass:"title white--text"},[a._v("Farmacia / Ingresos")])],1),t(f.Cl),t(o.Z,{attrs:{fab:"",small:"",color:"primary darken-2"},on:{click:function(t){return a.retroceder()}}},[t(g.Z,[a._v("far fa-arrow-alt-circle-left")])],1)],1),t(s.Z,{staticClass:"elevation-6",attrs:{color:"grey lighten-2"}},[t(l.ZB,{staticClass:"px-0"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{xs12:"","px-3":""}},[t(s.Z,{staticClass:"grey lighten-3"},[t(p.Z,{attrs:{"justify-center":"",row:"",wrap:""},on:{keypress:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.recargarDataTable(a.filtro)}}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.desde,"background-color":"cuarto lighten-5",color:"cuarto",label:"Desde",icon:"today",max:a.filtro.hasta,requerido:"true"},model:{value:a.filtro.desde,callback:function(t){a.$set(a.filtro,"desde",t)},expression:"filtro.desde"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.hasta,"background-color":"cuarto lighten-5",color:"cuarto",label:"Hasta",icon:"event",min:a.filtro.desde,requerido:"true"},model:{value:a.filtro.hasta,callback:function(t){a.$set(a.filtro,"hasta",t)},expression:"filtro.hasta"}})],1),t(m.Z,{attrs:{xs12:"",sm8:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{clearable:"","background-color":"cuarto lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Farmacia","prepend-icon":"fa-house-medical-flag",color:"cuarto",multiple:"",chips:"","deletable-chips":""},on:{"click:clear":function(t){a.$nextTick((()=>a.filtro.areas=[]))}},model:{value:a.filtro.areas,callback:function(t){a.$set(a.filtro,"areas",t)},expression:"filtro.areas"}})],1)],1),t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[t(o.Z,{staticClass:"white--text mb-2",attrs:{round:"",color:"cuarto darken-2",disabled:a.loading.estado,loading:a.loading.estado},on:{click:function(t){return a.recargarDataTable(a.filtro)}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("search")]),a._v(" Buscar Ingresos")],1),t(u.Z,{staticClass:"hidden-xs-only mx-4 my-1 black",attrs:{vertical:""}}),t(o.Z,{staticClass:"white--text mb-2",attrs:{round:"",color:"cuarto darken-2",disabled:a.loading.estado,loading:a.loading.estado},on:{click:function(t){return a.reporte()}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("fa-solid fa-file-pdf")]),a._v(" Ingresos PDF")],1)],1)],1)],1)],1)],1)],1)],1),t(m.Z,{attrs:{"pa-1":"","ma-1":"",xs12:"",cuarto:"","lighten-1":""}},[t(s.Z,{staticClass:"elevation-6"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",primary:""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("list_alt")]),t("span",{staticClass:"title white--text"},[a._v("Ingresos de Insumos")])],1)],1),t(n.Z,[t(m.Z,{attrs:{xs12:"",sm4:"","px-2":""}},[t(b.h,{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":"",clearable:""},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1),t(f.Cl),t(u.Z,{staticClass:"hidden-xs-only mx-2 primary",attrs:{inset:"",vertical:""}}),t(o.Z,{staticClass:"mb-2",attrs:{round:"",color:"primary",disabled:a.loading.estado||!(a.persona.farmacia.gestion?.length>0||a.persona.farmacia.general?.admin),loading:a.loading.estado},on:{click:function(t){return a.actualizarDialogIngresoTransferencia({state:!0,type:{ingreso:!0}})}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("input")]),a._v(" Nuevo Ingreso")],1)],1),t(d.Z,{staticClass:"elevation-6",staticStyle:{"table-layout":"fixed"},attrs:{id:"tablita",headers:a.headers,items:a.dataTable,"item-key":"_id",pagination:a.paginacion,loading:a.loading.estado,search:a.search},on:{"update:pagination":function(t){a.paginacion=t}},scopedSlots:a._u([{key:"no-results",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(' No se encontraron resultados para "'+a._s(a.search)+'". ')])]},proxy:!0},{key:"no-data",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(" No hay datos para mostrar. ")])]},proxy:!0},{key:"items",fn:function(e){return[t("tr",{class:a.backgroundClass(e.item)},[t("td",{staticClass:"text-sm-left"},[t("div",{staticClass:"text-xs-center",staticStyle:{width:"90px"}},[t(v.Z,{attrs:{top:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:i}){return[t(o.Z,a._g({attrs:{disabled:a.noAdminNoGestion||a.loading.estado||e.item.recibido||e.item.remito&&!e.item.retirado||a.noAdminSiGestion&&!a.persona.farmacia.gestion.includes(e.item.destino),color:"white",small:"",icon:""},on:{click:function(t){return a.recibirIngreso({ingreso:{id:e.item._id,orden_compra:e.item.orden_compra,remito:e.item.remito},finish:a.recargarDataTable})}}},i),[t(g.Z,{attrs:{color:e.item.recibido?"green":"red"}},[a._v(a._s(e.item.recibido?"task_alt":"radio_button_unchecked"))])],1)]}}],null,!0)},[t("span",[a._v("Recibir")])]),t(v.Z,{attrs:{right:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:i}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado,color:"white",small:"",icon:""},on:{click:function(t){return a.actualizarDialogIngresoTransferencia({state:!0,type:{ingreso:!!e.item.orden_compra,transferencia:!!e.item.remito},ingreso:{orden_compra:e.item.orden_compra?e.item:null,remito:e.item.remito?e.item:null},areasId:[e.item.origen,e.item.destino]})}}},i),[t(g.Z,{attrs:{color:"primary"}},[a._v("visibility")])],1)]}}],null,!0)},[t("span",[a._v("Ver Ingreso")])])],1)]),a._l(a.headersDinamics,(function(a){return t("td",{key:a.text,class:a.class},[t("bodyDataTableDinamic",{attrs:{props:e,field:a}})],1)}))],2)]}}])},[t(h.Z,{attrs:{color:"blue",indeterminate:""}})],1)],1)],1)],1),t("dialogIngreso",{attrs:{closeFinish:a.recargarDataTable}}),t("dialogTransferencia",{attrs:{closeFinish:a.recargarDataTable}})],1)},y=[],_=e(629),k=e(5967),Z=e(5167),E=e(7441),w=e(5049),D=e(445),C=e(4920),S=e(5730),F=function(){var a=this,t=a._self._c;return t(w.Z,{attrs:{"max-width":"80%",persistent:"",scrollable:""},model:{value:a.dialogIngreso.state,callback:function(t){a.$set(a.dialogIngreso,"state",t)},expression:"dialogIngreso.state"}},[t(s.Z,[t(C.Z,{attrs:{color:"grey lighten-2",height:"auto",window:""}},[t(g.Z,{attrs:{medium:"",color:"black darken-2"}},[a._v("input")]),t("span",{staticClass:"display-1 font-weight-bold text-capitalize black--text text--darken-2"},[a._v(a._s(a.dialogIngreso.orden_compra?`Editar: ${a.dataEdit.orden_compra}`:"Nuevo Ingreso"))]),t(f.Cl),t(g.Z,{attrs:{large:"",disabled:a.loading.estado,color:"error darken-1"},on:{click:a.close}},[a._v("cancel_presentation")])],1),t(l.ZB,[t(D.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:a.valido,callback:function(t){a.valido=t},expression:"valido"}},[t(c.Z,{attrs:{"grid-list-md":""}},[a.dialogIngreso.soloLectura?a._e():t(p.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(f.Cl),t(m.Z,{attrs:{xs12:"",sm6:"","px-2":""}},[t(E.Z,{attrs:{"false-value":!1,"true-value":!0,color:"primary lighten-1"},scopedSlots:a._u([{key:"label",fn:function(){return[t(g.Z,{attrs:{left:""}},[a._v("inventory_2")]),a._v(" Carga Inicial: "+a._s(a.cargaInicial?"Si":"No")+" ")]},proxy:!0}],null,!1,293394657),model:{value:a.cargaInicial,callback:function(t){a.cargaInicial=t},expression:"cargaInicial"}})],1),t(f.Cl)],1),t(p.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{soloLectura:a.dialogIngreso.soloLectura,clearable:!a.dialogIngreso.soloLectura,color:"primary",label:"Fecha",icon:"event",value:a.dataEdit.fecha,max:a.hoy,requerido:"true"},model:{value:a.dataEdit.fecha,callback:function(t){a.$set(a.dataEdit,"fecha",t)},expression:"dataEdit.fecha"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(b.h,{attrs:{readonly:a.dialogIngreso.soloLectura||"Carga inicial"===a.dataEdit.orden_compra,clearable:!(a.dialogIngreso.soloLectura||"Carga inicial"===a.dataEdit.orden_compra),"background-color":a.dialogIngreso.soloLectura||"Carga inicial"===a.dataEdit.orden_compra?"primary lighten-1":"primary lighten-5","prepend-icon":"list_alt",label:"Orden de Compra",placeholder:"YYYY-NumeroDeOrden",type:"text",color:"primary",rules:[...a.rules.requerido]},model:{value:a.dataEdit.orden_compra,callback:function(t){a.$set(a.dataEdit,"orden_compra",t)},expression:"dataEdit.orden_compra"}})],1),a.dialogIngreso.soloLectura?t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(b.h,{attrs:{readonly:"","background-color":"primary lighten-1",label:"Proveedor","prepend-icon":"local_shipping",type:"text",color:"primary"},model:{value:a.dataEdit.proveedor,callback:function(t){a.$set(a.dataEdit,"proveedor",t)},expression:"dataEdit.proveedor"}})],1):t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{attrs:{readonly:"Carga inicial"===a.dataEdit.proveedor,clearable:!("Carga inicial"===a.dataEdit.proveedor),"background-color":"Carga inicial"===a.dataEdit.proveedor?"primary lighten-1":"primary lighten-5",items:a.farmaciaProveedores,label:"Proveedor","prepend-icon":"local_shipping",color:"primary",rules:[...a.rules.requerido]},on:{"click:clear":function(t){a.$nextTick((()=>a.dataEdit.destino=""))}},model:{value:a.dataEdit.proveedor,callback:function(t){a.$set(a.dataEdit,"proveedor",t)},expression:"dataEdit.proveedor"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogIngreso.soloLectura,clearable:!a.dialogIngreso.soloLectura,"background-color":a.dialogIngreso.soloLectura?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Destino","prepend-icon":"fa-house-medical-flag",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.destino,callback:function(t){a.$set(a.dataEdit,"destino",t)},expression:"dataEdit.destino"}})],1),t(m.Z,{attrs:{xs12:"","px-3":"",primary:"","darken-3":""}},[t("h4",{staticClass:"title float: left white--text"},[a._v("Insumos a Ingresar")])]),a._l(a.dataEdit.insumos,(function(e,i){return t(m.Z,{key:`insumos-${i}`,attrs:{xs12:""}},[t(p.Z,{class:"grey lighten-"+(i%2===0?"3":"2"),attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dataEdit.insumos[i].recibido,clearable:!a.dataEdit.insumos[i].recibido,"background-color":a.dataEdit.insumos[i].recibido?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"nombreC",items:a.insumosDB,label:"Insumo","prepend-icon":"fa-solid fa-pills",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},on:{"click:clear":function(t){a.$nextTick((()=>a.dataEdit.insumos[i].insumo=""))}},model:{value:a.dataEdit.insumos[i].insumo,callback:function(t){a.$set(a.dataEdit.insumos[i],"insumo",t)},expression:"dataEdit.insumos[index].insumo"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dataEdit.insumos[i].recibido,clearable:!a.dataEdit.insumos[i].recibido,"background-color":a.dataEdit.insumos[i].recibido?"primary lighten-1":"primary lighten-5",items:a.ingresoProcedencia,label:"Procedencia","prepend-icon":"trip_origin",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},on:{"click:clear":function(t){a.$nextTick((()=>a.dataEdit.insumos[i].procedencia=""))}},model:{value:a.dataEdit.insumos[i].procedencia,callback:function(t){a.$set(a.dataEdit.insumos[i],"procedencia",t)},expression:"dataEdit.insumos[index].procedencia"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"",lg3:"","px-3":""}},[t(b.h,{attrs:{readonly:a.dataEdit.insumos[i].recibido,clearable:!a.dataEdit.insumos[i].recibido,"background-color":a.dataEdit.insumos[i].recibido?"primary lighten-1":"primary lighten-5","prepend-icon":"group_work",label:"Lote",type:"text",color:"primary"},model:{value:a.dataEdit.insumos[i].lote,callback:function(t){a.$set(a.dataEdit.insumos[i],"lote",t)},expression:"dataEdit.insumos[index].lote"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"",lg4:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.dataEdit.insumos[i].vencimiento,soloLectura:a.dataEdit.insumos[i].recibido,clearable:!a.dataEdit.insumos[i].recibido,color:"primary",label:"Fecha de Vencimiento",icon:"event",min:a.hoy,requerido:!1},model:{value:a.dataEdit.insumos[i].vencimiento,callback:function(t){a.$set(a.dataEdit.insumos[i],"vencimiento",t)},expression:"dataEdit.insumos[index].vencimiento"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"",lg3:"","px-3":""}},[t(b.h,{attrs:{readonly:a.dataEdit.insumos[i].recibido,clearable:!a.dataEdit.insumos[i].recibido,"background-color":a.dataEdit.insumos[i].recibido?"primary lighten-1":"primary lighten-5","prepend-icon":"grain",label:"Cantidad",type:"number",onkeydown:"return event.key !== 'e' && event.key !== 'E' && event.key !== '.' && event.key !== ',' && event.key !== '+' && event.key !== '-'",color:"primary",rules:[...a.rules.requerido,...a.rules.soloNumero,a.rules.minNumber(1)],"validate-on-blur":""},model:{value:a.dataEdit.insumos[i].cantidad,callback:function(t){a.$set(a.dataEdit.insumos[i],"cantidad",t)},expression:"dataEdit.insumos[index].cantidad"}})],1),t(f.Cl),0==i?t(v.Z,{attrs:{top:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:e}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado||!!a.dataEdit.recibido,fab:"",small:"",color:"primary"},on:{click:function(t){return a.agregarFila(a.dataEdit.insumos,{...a.dataEditBase.insumos[0]})}}},e),[t(g.Z,{attrs:{"x-large":""}},[a._v("control_point")])],1)]}}],null,!0)},[t("span",[a._v("Agregar Insumo Ingreso")])]):a._e(),0!=i?t(v.Z,{attrs:{top:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:e}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado||a.dataEdit.insumos[i].recibido,small:"",icon:"",color:"white"},on:{click:function(t){return a.borrarFila(a.dataEdit.insumos,i)}}},e),[t(g.Z,{attrs:{color:"red lighten-2"}},[a._v("delete_forever")])],1)]}}],null,!0)},[t("span",[a._v("Eliminar Insumo")])]):a._e(),t(f.Cl)],1)],1)})),t(m.Z,{attrs:{xs12:"","mx-3":""}},[t(S.Z,{attrs:{readonly:a.dialogIngreso.soloLectura,clearable:!a.dialogIngreso.soloLectura,"background-color":a.dialogIngreso.soloLectura?"primary lighten-1":"primary lighten-5",label:"Observacion (opcional)",color:"primary","prepend-icon":"description","auto-grow":"",rows:"2"},model:{value:a.dataEdit.observacion,callback:function(t){a.$set(a.dataEdit,"observacion",t)},expression:"dataEdit.observacion"}})],1),a.dialogIngreso.soloLectura?t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(b.h,{attrs:{readonly:"","background-color":"primary lighten-1","prepend-icon":"local_shipping",label:"Fecha Recibido en Destino",placeholder:"Sin Recibir",type:"text",color:"primary"},model:{value:a.dataEdit.recibido,callback:function(t){a.$set(a.dataEdit,"recibido",t)},expression:"dataEdit.recibido"}})],1):a._e()],2)],1)],1)],1),t(l.h7,[t(p.Z,{attrs:{row:"",wrap:""}},[t(o.Z,a._g({attrs:{disabled:a.loading.estado||!!a.dataEdit.recibido,round:"",color:"primary"},on:{click:function(t){return a.agregarFila(a.dataEdit.insumos,{...a.dataEditBase.insumos[0]})}}},a.on),[t(g.Z,{attrs:{large:"",left:""}},[a._v("control_point")]),a._v("Insumo Ingreso ")],1),t(f.Cl),t(o.Z,{staticClass:"error darken-1",attrs:{disabled:a.loading.estado,round:"",loading:a.loading.estado},on:{click:a.close}},[a._v(" Cancelar ")]),t(o.Z,{staticClass:"primary darken-1 white--text",attrs:{disabled:a.loading.estado||!!a.dataEdit.recibido,loading:a.loading.estado,round:""},on:{click:function(t){return a.guardarIngreso({ingreso:a.dataEdit,validate:a.$refs.form.validate,finish:a.close})}}},[a._v(" "+a._s(a.valido?a.dialogIngreso.orden_compra?"Guardar Cambios":"Crear Ingreso":"Formulario No valido")+" ")])],1)],1)],1)],1)},T=[],B={name:"dialogIngreso",props:["closeFinish"],components:{dateSelect:k.Z},data:()=>({valido:!0,cargaInicial:!1,farmaciaProveedores:[],insumosDB:[],areasFiltro:[],dataEdit:{},dataEditBase:{fecha:"",orden_compra:"",proveedor:"",destino:"",insumos:[{insumo:void 0,cantidad:null,procedencia:"",lote:"",vencimiento:""}],observacion:"",recibido:""}}),computed:{...(0,_.rn)(["loading","hoy","persona","rules"]),...(0,_.rn)("farmacia",["dialogIngreso","ingresoProcedencia"])},watch:{async"dialogIngreso.state"(a){if(a){this.farmaciaProveedores=[...await this.returnConfig("farmaciaProveedores")||[],{text:"Carga inicial",disabled:!0}],this.insumosDB=await this.buscarInsumosFiltro({select:"nombre descripcion nombreC"});let a=[...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})];if(this.areasFiltro=this.persona.farmacia?.general?.admin?a:await this.filtrarArrayParaSelectsDisabled({arraySelects:a,arrayEnable:this.persona.farmacia?.gestion,propCompare:"_id"}),this.dialogIngreso.orden_compra){let a=this._cloneDeep(this.dialogIngreso.orden_compra);for(let t=0;t<a.insumos.length;t++)a.insumos[t].vencimiento=this.mostrarFecha(a.insumos[t].vencimiento);this.dataEdit=Object.assign(this._cloneDeep(this.dataEditBase),a)}else this.dataEdit=this._cloneDeep(this.dataEditBase),this.cargaInicial=!1}else this.dataEdit=this._cloneDeep(this.dataEditBase);this.$refs.form.resetValidation()},cargaInicial(a){a?(this.dataEdit.orden_compra="Carga inicial",this.dataEdit.proveedor="Carga inicial"):(this.dataEdit.orden_compra="",this.dataEdit.proveedor="")},"dataEdit.orden_compra"(a){"Carga inicial"===a&&(this.dataEdit.proveedor="Carga inicial",this.cargaInicial=!0)},"dataEdit.proveedor"(a){"Carga inicial"===a&&(this.dataEdit.orden_compra="Carga inicial",this.cargaInicial=!0)}},beforeMount(){this.dataEditBase.fecha=this.hoy,this.dataEdit=this._cloneDeep(this.dataEditBase)},methods:{...(0,_.nv)(["returnConfig","filtrarArrayParaSelectsDisabled"]),...(0,_.nv)("main_areas",["buscarAreaFiltros"]),...(0,_.nv)("farmacia",["actualizarDialogIngresoTransferencia","buscarInsumosFiltro","guardarIngreso"]),close(){this.actualizarDialogIngresoTransferencia({state:!1,type:{ingreso:!0}}),this.closeFinish()},agregarFila(a,t){a.push(t||"")},borrarFila(a,t){a.splice(t,1)}}},I=B,z=e(1001),$=(0,z.Z)(I,F,T,!1,null,null,null),L=$.exports,A=e(8593),P={name:"farmaciaIngresoBuscar",components:{dateSelect:k.Z,bodyDataTableDinamic:Z.Z,dialogIngreso:L,dialogTransferencia:A.Z},data:()=>({areasFiltro:[],noAdminNoGestion:!1,noAdminSiGestion:!1,dataTable:[],filtro:{desde:(new Date).getFullYear()-1+"-"+((new Date).getMonth()+1).toString().padStart(2,0)+"-01",hasta:"",areas:[]},ultimoFiltro:{},search:"",paginacion:{sortBy:"fecha",descending:!0,page:1,rowsPerPage:10},headers:[{text:"Acciones",value:"id",align:"center",sortable:!1,width:"5%",ignore:!0},{text:"Fecha",value:"fecha",align:"left",class:"text-xs-left",width:"10%",ruta:"fecha",date:!0},{text:"Orden de Compra",value:"orden_compra",align:"left",class:"text-xs-right",width:"15%",ruta:"orden_compra"},{text:"Proveedor",value:"proveedor",align:"left",class:"text-capitalize text-xs-left",width:"15%",ruta:"proveedor"},{text:"Remito Transf.",value:"remito",align:"left",class:"text-xs-right",width:"15%",ruta:"remito"},{text:"Transf. Origen",value:"origenDB",align:"left",class:"text-capitalize text-xs-left",width:"15%",ruta:"origenDB"},{text:"Destino",value:"destinoDB",align:"left",class:"text-capitalize text-xs-left",width:"20%",ruta:"destinoDB"},{text:"Recibido Destino",value:"recibido",align:"left",class:"text-xs-left",width:"10%",ruta:"recibido",date:!0},{text:"Retirado Origen",value:"retirado",align:"left",class:"text-xs-left",width:"10%",ruta:"retirado",date:!0}]}),computed:{...(0,_.rn)(["loading","hoy","persona"]),headersDinamics(){return[...this.headers.filter((a=>!0!==a.ignore))]}},async created(){this.filtro.hasta=this.hoy,this.persona.farmacia.general?.admin||(this.persona.farmacia.gestion?this.noAdminSiGestion=!0:this.noAdminNoGestion=!0);let a=[...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})];this.persona.farmacia.general?.reportes||this.persona.farmacia.general?.admin?(this.areasFiltro=a,this.filtro.areas=a.map((a=>a.id))):(this.areasFiltro=await this.filtrarArrayParaSelectsDisabled({arraySelects:a,arrayEnable:this.persona.farmacia.gestion,propCompare:"_id"}),this.filtro.areas=[...this.persona.farmacia.gestion]),await this.recargarDataTable(this.filtro)},methods:{...(0,_.OI)(["mostrarError","mostrarDialogIframe"]),...(0,_.nv)(["retroceder","routerResolve","filtrarArrayParaSelectsDisabled"]),...(0,_.nv)("main_areas",["buscarAreaFiltros"]),...(0,_.nv)("farmacia",["actualizarDialogIngresoTransferencia","buscarIngresosAgrupados","recibirIngreso"]),backgroundClass(a){if(!a)return"";try{return a.recibido?"background-color: green lighten-5":a.remito&&!a.retirado?"background-color: yellow lighten-4":"background-color: blue lighten-4"}catch(t){return""}},async recargarDataTable(a){if(a){let t=await this.buscarIngresosAgrupados(a);t&&(this.dataTable=t,this.ultimoFiltro=this._cloneDeep(a))}else this.dataTable=await this.buscarIngresosAgrupados(this.ultimoFiltro)},async reporte(){if(this.filtro.areas.length>0){localStorage.setItem("pdfTemp",JSON.stringify(this.filtro));let a=await this.routerResolve({name:"FarmaciaIngresosImprimir",query:{descarga:!1}});this.mostrarDialogIframe({src:a.href,titulo_name:`Farmacia Ingresos ${this.filtro.desde} ~ ${this.filtro.hasta}`})}else this.mostrarError({errores:"",mensaje:"Complete por lo menos con una Farmacia para el reporte.",titulo:"Valores Requeridos."})}}},R=P,O=(0,z.Z)(R,x,y,!1,null,null,null),j=O.exports},5086:function(a,t,e){e.r(t),e.d(t,{default:function(){return R}});var i=e(8469),r=e(7416),o=e(6194),s=e(8956),l=e(2353),n=e(9418),c=e(6530),d=e(7352),u=e(108),m=e(683),g=e(3667),p=e(9456),h=e(6446),f=e(8143),b=e(4618),v=e(1415),x=function(){var a=this,t=a._self._c;return t(c.Z,{attrs:{fluid:"","grid-list-xs":""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(s.Z,{staticClass:"white--text",attrs:{color:"cuarto darken-2"}},[t(l.ZB,{staticClass:"px-0 text-uppercase"},[a._v("====== Gestion de Farmacia ======")])],1)],1)],1),t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",cuarto:"","darken-1":""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("medication")]),t("span",{staticClass:"title white--text"},[a._v("Farmacia / Solicitudes")])],1),t(f.Cl),t(o.Z,{attrs:{fab:"",small:"",color:"primary darken-2"},on:{click:function(t){return a.retroceder()}}},[t(g.Z,[a._v("far fa-arrow-alt-circle-left")])],1)],1),t(s.Z,{staticClass:"elevation-6",attrs:{color:"grey lighten-2"}},[t(l.ZB,{staticClass:"px-0"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{xs12:"","px-3":""}},[t(s.Z,{staticClass:"grey lighten-3"},[t(p.Z,{attrs:{"justify-center":"",row:"",wrap:""},on:{keypress:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.recargarDataTable(a.filtro)}}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.desde,"background-color":"cuarto lighten-5",color:"cuarto",label:"Desde",icon:"today",max:a.filtro.hasta,requerido:"true"},model:{value:a.filtro.desde,callback:function(t){a.$set(a.filtro,"desde",t)},expression:"filtro.desde"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.hasta,"background-color":"cuarto lighten-5",color:"cuarto",label:"Hasta",icon:"event",min:a.filtro.desde,requerido:"true"},model:{value:a.filtro.hasta,callback:function(t){a.$set(a.filtro,"hasta",t)},expression:"filtro.hasta"}})],1),t(m.Z,{attrs:{xs12:"",sm8:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{clearable:"","background-color":"cuarto lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Farmacia Origen","prepend-icon":"fa-house-medical-flag",color:"cuarto",multiple:"",chips:"","deletable-chips":""},on:{"click:clear":function(t){a.$nextTick((()=>a.filtro.areas=[]))}},model:{value:a.filtro.areas,callback:function(t){a.$set(a.filtro,"areas",t)},expression:"filtro.areas"}})],1)],1),t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[t(o.Z,{staticClass:"white--text mb-2",attrs:{round:"",color:"cuarto darken-2",disabled:a.loading.estado,loading:a.loading.estado},on:{click:function(t){return a.recargarDataTable(a.filtro)}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("search")]),a._v(" Buscar Solicitudes")],1),t(u.Z,{staticClass:"hidden-xs-only mx-4 my-1 black",attrs:{vertical:""}}),t(o.Z,{staticClass:"white--text mb-2",attrs:{round:"",color:"cuarto darken-2",disabled:a.loading.estado,loading:a.loading.estado},on:{click:function(t){return a.reporte()}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("fa-solid fa-file-pdf")]),a._v(" Solicitudes Pendientes PDF")],1)],1)],1)],1)],1)],1)],1)],1),t(m.Z,{attrs:{"pa-1":"","ma-1":"",xs12:"",cuarto:"","lighten-1":""}},[t(s.Z,{staticClass:"elevation-6"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",primary:""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("speaker_notes")]),t("span",{staticClass:"title white--text"},[a._v("Solicitudes de Insumos")])],1),t(f.Cl)],1),t(n.Z,[t(m.Z,{attrs:{xs12:"",sm4:"","px-2":""}},[t(b.h,{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":"",clearable:""},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1),t(f.Cl),t(u.Z,{staticClass:"hidden-xs-only mx-2 my-1 primary",attrs:{vertical:""}}),t(o.Z,{staticClass:"mb-2",attrs:{round:"",color:"primary",disabled:a.loading.estado||!(a.persona.farmacia.gestion?.length>0||a.persona.farmacia.general?.admin),loading:a.loading.estado},on:{click:function(t){return a.actualizarDialogSolicitud({state:!0})}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("input")]),a._v(" Nueva Solicitud")],1)],1),t(d.Z,{staticClass:"elevation-6",staticStyle:{"table-layout":"fixed"},attrs:{id:"tablita",headers:a.headers,items:a.dataTable,"item-key":"_id",pagination:a.paginacion,loading:a.loading.estado,search:a.search},on:{"update:pagination":function(t){a.paginacion=t}},scopedSlots:a._u([{key:"no-results",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(' No se encontraron resultados para "'+a._s(a.search)+'". ')])]},proxy:!0},{key:"no-data",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(" No hay datos para mostrar. ")])]},proxy:!0},{key:"items",fn:function(e){return[t("tr",{class:a.backgroundClass(e.item)},[t("td",{staticClass:"text-sm-left"},[t("div",{staticClass:"text-xs-center"},[t(v.Z,{attrs:{right:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:i}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado,color:"white",small:"",icon:""},on:{click:function(t){return a.actualizarDialogSolicitud({state:!0,solicitud:e.item})}}},i),[t(g.Z,{attrs:{color:"primary"}},[a._v("visibility")])],1)]}}],null,!0)},[t("span",[a._v("Ver Solicitud")])])],1)]),a._l(a.headersDinamics,(function(i){return t("td",{key:i.text,class:i.class,staticStyle:{cursor:"pointer"},on:{click:function(t){return a.actualizarDialogSolicitud({state:!0,solicitud:e.item})}}},[t("bodyDataTableDinamic",{attrs:{props:e,field:i}})],1)}))],2)]}}])},[t(h.Z,{attrs:{color:"blue",indeterminate:""}})],1)],1)],1)],1),t("dialogSolicitud",{attrs:{closeFinish:a.recargarDataTable}})],1)},y=[],_=e(629),k=e(5967),Z=e(5167),E=e(5049),w=e(445),D=e(4920),C=e(5730),S=function(){var a=this,t=a._self._c;return t(E.Z,{attrs:{"max-width":"80%",persistent:"",scrollable:""},model:{value:a.dialogSolicitud.state,callback:function(t){a.$set(a.dialogSolicitud,"state",t)},expression:"dialogSolicitud.state"}},[t(s.Z,[t(D.Z,{attrs:{color:"grey lighten-2",height:"auto",window:""}},[t(g.Z,{attrs:{medium:"",color:"black darken-2"}},[a._v("speaker_notes")]),t("span",{staticClass:"display-1 font-weight-bold text-capitalize black--text text--darken-2"},[a._v(a._s(a.dialogSolicitud.solicitud?"Solicitud":"Nueva Solicitud"))]),t(f.Cl),t(g.Z,{attrs:{large:"",disabled:a.loading.estado,color:"error darken-1"},on:{click:a.close}},[a._v("cancel_presentation")])],1),t(l.ZB,[t(w.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:a.valido,callback:function(t){a.valido=t},expression:"valido"}},[t(c.Z,{attrs:{"grid-list-md":""}},[t(p.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(b.h,{attrs:{readonly:"","background-color":"primary lighten-1","prepend-icon":"event",label:"Fecha",type:"text",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.fecha,callback:function(t){a.$set(a.dataEdit,"fecha",t)},expression:"dataEdit.fecha"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{attrs:{readonly:a.dialogSolicitud.soloLectura,clearable:!a.dialogSolicitud.soloLectura,"background-color":`${"Pendiente"===a.dataEdit.estado?"yellow":"Rechazada"===a.dataEdit.estado?"red":"green"} ${a.dialogSolicitud.soloLectura?"lighten-1":"lighten-4"}`,items:a.solicitudEstados,label:"Estado","prepend-icon":"Aceptada"===a.dataEdit.estado?"check_box":"Rechazada"===a.dataEdit.estado?"disabled_by_default":"check_box_outline_blank",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.estado,callback:function(t){a.$set(a.dataEdit,"estado",t)},expression:"dataEdit.estado"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{attrs:{readonly:a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada,clearable:!(a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada),"background-color":`${"Rutina"===a.dataEdit.motivo?"blue":"Urgencia"===a.dataEdit.motivo?"yellow":"orange"} ${a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada?"lighten-1":"lighten-4"}`,items:a.solicitudMotivos,label:"Motivo","prepend-icon":"speaker_notes",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.motivo,callback:function(t){a.$set(a.dataEdit,"motivo",t)},expression:"dataEdit.motivo"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada,clearable:!(a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada),"background-color":a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Origen","prepend-icon":"fa-house-medical-flag",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.origen,callback:function(t){a.$set(a.dataEdit,"origen",t)},expression:"dataEdit.origen"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogSolicitud.soloLectura||"Pendiente"===a.dataEdit.estado&&a.dialogSolicitud.edicionLimitada,clearable:!(a.dialogSolicitud.soloLectura||"Pendiente"===a.dataEdit.estado&&a.dialogSolicitud.edicionLimitada),"background-color":a.dialogSolicitud.soloLectura||"Pendiente"===a.dataEdit.estado&&a.dialogSolicitud.edicionLimitada?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"area",items:"Aceptada"===a.dataEdit.estado?a.areasFiltroDestino:"Rechazada"===a.dataEdit.estado?a.areasFiltro:a.areasDB,label:""+("Aceptada"===a.dataEdit.estado?"Aceptada por:":"Rechazada"===a.dataEdit.estado?"Rechazada por:":"Destinatario (Opcional)"),"prepend-icon":"fa-solid fa-dolly",color:"primary",rules:"Aceptada"===a.dataEdit.estado||"Rechazada"===a.dataEdit.estado?[...a.rules.requerido]:[],"validate-on-blur":""},on:{"click:clear":function(t){a.$nextTick((()=>a.dataEdit.destino=""))}},model:{value:a.dataEdit.destino,callback:function(t){a.$set(a.dataEdit,"destino",t)},expression:"dataEdit.destino"}})],1),t(m.Z,{attrs:{xs12:"","px-3":"",primary:"","darken-3":""}},[t("h4",{staticClass:"title float: left white--text"},[a._v("Insumos a Solicitar")])]),a._l(a.dataEdit.insumos,(function(e,i){return t(m.Z,{key:`insumos-${i}`,attrs:{xs12:""}},[t(p.Z,{class:"grey lighten-"+(i%2===0?"3":"2"),attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{readonly:a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada,clearable:!(a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada),"background-color":a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada?"primary lighten-1":"primary lighten-5","item-value":"id","item-text":"nombreC",items:a.insumosFiltrado,label:"Insumo","prepend-icon":"fa-solid fa-pills",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},on:{"click:clear":function(t){a.$nextTick((()=>a.dataEdit.insumos[i].insumo=""))}},model:{value:a.dataEdit.insumos[i].insumo,callback:function(t){a.$set(a.dataEdit.insumos[i],"insumo",t)},expression:"dataEdit.insumos[index].insumo"}})],1),t(m.Z,{attrs:{xs12:"",sm4:"","px-3":""}},[t(b.h,{attrs:{readonly:a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada,clearable:!(a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada),"background-color":a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada?"primary lighten-1":"primary lighten-5","prepend-icon":"grain",label:"Cantidad",type:"number",onkeydown:"return event.key !== 'e' && event.key !== 'E' && event.key !== '.' && event.key !== ',' && event.key !== '+' && event.key !== '-'",color:"primary",rules:[...a.rules.requerido,...a.rules.soloNumero,a.rules.minNumber(1)],"validate-on-blur":""},model:{value:a.dataEdit.insumos[i].cantidad,callback:function(t){a.$set(a.dataEdit.insumos[i],"cantidad",t)},expression:"dataEdit.insumos[index].cantidad"}})],1),t(f.Cl),0==i?t(v.Z,{attrs:{top:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:e}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado||a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada,fab:"",small:"",color:"primary"},on:{click:function(t){return a.agregarFila(a.dataEdit.insumos,{...a.dataEditBase.insumos[0]})}}},e),[t(g.Z,{attrs:{"x-large":""}},[a._v("control_point")])],1)]}}],null,!0)},[t("span",[a._v("Agregar Insumo Solicitar")])]):a._e(),0!=i?t(v.Z,{attrs:{top:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:e}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado||a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada,small:"",icon:"",color:"white"},on:{click:function(t){return a.borrarFila(a.dataEdit.insumos,i)}}},e),[t(g.Z,{attrs:{color:"red lighten-2"}},[a._v("delete_forever")])],1)]}}],null,!0)},[t("span",[a._v("Eliminar Insumo")])]):a._e(),t(f.Cl)],1)],1)}))],2),t(p.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},["Aceptada"===a.dataEdit.estado||"Rechazada"===a.dataEdit.estado?t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(b.h,{attrs:{readonly:"","background-color":"primary lighten-1","prepend-icon":"event",label:"Fecha de Resolucion",type:"text",color:"primary",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.fec_resolucion,callback:function(t){a.$set(a.dataEdit,"fec_resolucion",t)},expression:"dataEdit.fec_resolucion"}})],1):a._e(),"Aceptada"===a.dataEdit.estado?t(m.Z,{attrs:{xs12:"","mx-2":""}},[t(C.Z,{attrs:{readonly:a.dialogSolicitud.soloLectura,clearable:!a.dialogSolicitud.soloLectura,"background-color":a.dialogSolicitud.soloLectura?"primary lighten-1":"primary lighten-5",label:"Condicion con la que se acepto (Opcional)",placeholder:"Si de alguno de los insumos se enviara menor cantidad, completar aca para avisar.",color:"primary","prepend-icon":"speaker_notes","auto-grow":"",rows:"2"},model:{value:a.dataEdit.condicion_aceptada,callback:function(t){a.$set(a.dataEdit,"condicion_aceptada",t)},expression:"dataEdit.condicion_aceptada"}})],1):a._e(),"Rechazada"===a.dataEdit.estado?t(m.Z,{attrs:{xs12:"","mx-2":""}},[t(C.Z,{attrs:{readonly:a.dialogSolicitud.soloLectura,clearable:!a.dialogSolicitud.soloLectura,"background-color":a.dialogSolicitud.soloLectura?"primary lighten-1":"primary lighten-5",label:"Motivo de Rechazo",color:"primary","prepend-icon":"speaker_notes","auto-grow":"",rows:"2",rules:[...a.rules.requerido],"validate-on-blur":""},model:{value:a.dataEdit.motivo_rechazo,callback:function(t){a.$set(a.dataEdit,"motivo_rechazo",t)},expression:"dataEdit.motivo_rechazo"}})],1):a._e()],1)],1)],1)],1),t(l.h7,[t(p.Z,{attrs:{row:"",wrap:""}},[t(o.Z,a._g({attrs:{disabled:a.loading.estado||a.dialogSolicitud.soloLectura||a.dialogSolicitud.edicionLimitada,round:"",color:"primary"},on:{click:function(t){return a.agregarFila(a.dataEdit.insumos,{...a.dataEditBase.insumos[0]})}}},a.on),[t(g.Z,{attrs:{large:"",left:""}},[a._v("control_point")]),a._v("insumo Solicitar ")],1),t(f.Cl),t(o.Z,{staticClass:"error darken-1",attrs:{disabled:a.loading.estado,round:"",loading:a.loading.estado},on:{click:a.close}},[a._v(" Cancelar ")]),t(o.Z,{staticClass:"primary darken-1 white--text",attrs:{disabled:a.loading.estado||a.dialogSolicitud.soloLectura,loading:a.loading.estado,round:""},on:{click:function(t){return a.guardarSolicitud({solicitud:a.dataEdit,validate:a.$refs.form.validate,finish:a.close})}}},[a._v(" "+a._s(a.valido?a.dialogSolicitud.solicitud?"Guardar Cambios":"Crear Solicitud":"Formulario No valido")+" ")])],1)],1)],1)],1)},F=[],T={name:"dialogSolicitud",props:["closeFinish"],components:{},data:()=>({valido:!0,areasDB:[],areasFiltro:[],areasFiltroDestino:[],insumosDB:[],insumosFiltrado:[],dataEdit:{},dataEditBase:{fecha:"",origen:"",destino:"",insumos:[{insumo:void 0,cantidad:null}],estado:"Pendiente",motivo:"Rutina",fec_resolucion:"",condicion_aceptada:"",motivo_rechazo:""}}),computed:{...(0,_.rn)(["loading","hoy","persona","rules"]),...(0,_.rn)("farmacia",["dialogSolicitud","solicitudEstados","solicitudMotivos"]),stockASolicitar(){return this.dataEdit.insumos?.map((a=>a.insumo))}},watch:{async"dialogSolicitud.state"(a){a?(this.insumosDB=await this.buscarInsumosFiltro({select:"nombre descripcion nombreC"}),this.insumosFiltrado=this.insumosDB,this.areasDB.push(...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})),this.areasFiltro=this.persona.farmacia.general?.admin?this.areasDB:await this.filtrarArrayParaSelectsDisabled({arraySelects:this.areasDB,arrayEnable:this.persona.farmacia.gestion,propCompare:"_id"}),this.dialogSolicitud.solicitud?this.dataEdit=Object.assign(this._cloneDeep(this.dataEditBase),this._cloneDeep(this.dialogSolicitud.solicitud)):this.dataEdit=this._cloneDeep(this.dataEditBase)):this.dataEdit=this._cloneDeep(this.dataEditBase),this.$refs.form.resetValidation()},"dataEdit.estado"(a){"Aceptada"===a||"Rechazada"===a?(this.dataEdit.fec_resolucion||(this.dataEdit.fec_resolucion=this.hoy,this.dataEdit.destino=""),"Aceptada"===a&&(this.changeAreasFiltroDestino(),this.dataEdit.origen===this.dataEdit.destino&&(this.dataEdit.destino=""))):this.dataEdit.fec_resolucion&&(this.dataEdit.fec_resolucion="",this.dataEdit.destino=""),"Aceptada"!==a&&(this.dataEdit.condicion_aceptada=""),"Rechazada"!==a&&(this.dataEdit.motivo_rechazo="")},"dataEdit.origen"(a){a&&"Aceptada"===this.dataEdit.estado&&(this.changeAreasFiltroDestino(),this.dataEdit.origen===this.dataEdit.destino&&(this.dataEdit.destino=""))},async stockASolicitar(a){this.insumosFiltrado=await this.filtrarArrayParaSelectsDisabled({arraySelects:this.insumosDB,arrayDisable:a,propCompare:"id"})}},beforeMount(){this.dataEditBase.fecha=this.hoy,this.dataEdit=this._cloneDeep(this.dataEditBase)},methods:{...(0,_.nv)(["filtrarArrayParaSelectsDisabled"]),...(0,_.nv)("main_areas",["buscarAreaFiltros"]),...(0,_.nv)("farmacia",["actualizarDialogSolicitud","buscarInsumosFiltro","guardarSolicitud"]),async changeAreasFiltroDestino(){this.areasFiltroDestino=await this.filtrarArrayParaSelectsDisabled({arraySelects:this.areasFiltro,arrayDisable:this.dataEdit.origen,propCompare:"_id"})},close(){this.actualizarDialogSolicitud({state:!1}),this.closeFinish()},agregarFila(a,t){a.push(t||"")},borrarFila(a,t){a.splice(t,1)}}},B=T,I=e(1001),z=(0,I.Z)(B,S,F,!1,null,null,null),$=z.exports,L={name:"farmaciaSolicitudBuscar",components:{dateSelect:k.Z,bodyDataTableDinamic:Z.Z,dialogSolicitud:$},data:()=>({areasFiltro:[],dataTable:[],filtro:{desde:(new Date).getFullYear()-1+"-"+((new Date).getMonth()+1).toString().padStart(2,0)+"-01",hasta:"",areas:[]},ultimoFiltro:{},search:"",paginacion:{sortBy:"fecha",descending:!0,page:1,rowsPerPage:10},headers:[{text:"Acciones",value:"id",align:"center",sortable:!1,width:"5%",ignore:!0},{text:"Fecha",value:"fecha",align:"left",class:"text-xs-left",width:"15%",ruta:"fecha",date:!0},{text:"Origen",value:"origenDB",align:"left",class:"text-capitalize text-xs-left",width:"15%",ruta:"origenDB"},{text:"Dirigida a",value:"destinoDB",align:"left",class:"text-capitalize text-xs-left",width:"20%",ruta:"destinoDB"},{text:"Estado",value:"estado",align:"left",class:"text-xs-left",width:"10%",ruta:"estado"},{text:"Motivo",value:"motivo",align:"left",class:"text-xs-left",width:"10%",ruta:"motivo"}]}),computed:{...(0,_.rn)(["loading","hoy","persona"]),headersDinamics(){return[...this.headers.filter((a=>!0!==a.ignore))]}},async created(){this.filtro.hasta=this.hoy;let a=[...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})];this.persona.farmacia.general?.reportes||this.persona.farmacia.general?.admin?(this.areasFiltro=a,this.filtro.areas=a.map((a=>a.id))):(this.areasFiltro=await this.filtrarArrayParaSelectsDisabled({arraySelects:a,arrayEnable:this.persona.farmacia.gestion,propCompare:"_id"}),this.filtro.areas=[...this.persona.farmacia.gestion]),await this.recargarDataTable(this.filtro)},methods:{...(0,_.OI)(["mostrarError","mostrarDialogIframe"]),...(0,_.nv)(["retroceder","routerResolve","filtrarArrayParaSelectsDisabled"]),...(0,_.nv)("main_areas",["buscarAreaFiltros"]),...(0,_.nv)("farmacia",["actualizarDialogSolicitud","buscarSolicitudesFiltro"]),backgroundClass(a){if(!a)return"";try{if("Aceptada"===a.estado)return"background-color: green lighten-5";if("Rechazada"===a.estado)return"background-color: red lighten-4";if("Rutina"===a.motivo)return"background-color: blue lighten-4";if("Urgencia"===a.motivo)return"background-color: yellow lighten-4";if("Emergencia"===a.motivo)return"background-color: orange lighten-2"}catch(t){return""}},async recargarDataTable(a){if(a){let t=await this.buscarSolicitudesFiltro(a);t&&(this.dataTable=t,this.ultimoFiltro=this._cloneDeep(a))}else this.dataTable=await this.buscarSolicitudesFiltro(this.ultimoFiltro)},async reporte(){if(alert("En Desarrollo."),this.filtro.areas.length>0){localStorage.setItem("pdfTemp",JSON.stringify(this.filtro));let a=await this.routerResolve({name:"FarmaciaSolicitudImprimir",query:{descarga:!1}});this.mostrarDialogIframe({src:a.href,titulo_name:`Farmacia Solicitudes ${this.filtro.desde} ~ ${this.filtro.hasta}`})}else this.mostrarError({errores:"",mensaje:"Complete por lo menos con una Farmacia para el reporte.",titulo:"Valores Requeridos."})}}},A=L,P=(0,I.Z)(A,x,y,!1,null,null,null),R=P.exports},4393:function(a,t,e){e.r(t),e.d(t,{default:function(){return F}});var i=e(8469),r=e(7416),o=e(6194),s=e(8956),l=e(2353),n=e(9418),c=e(6530),d=e(7352),u=e(108),m=e(683),g=e(3667),p=e(9456),h=e(6446),f=e(8143),b=e(4618),v=e(1415),x=function(){var a=this,t=a._self._c;return t(c.Z,{attrs:{fluid:"","grid-list-xs":""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(s.Z,{staticClass:"white--text",attrs:{color:"cuarto darken-2"}},[t(l.ZB,{staticClass:"px-0 text-uppercase"},[a._v("====== Gestion de Farmacia ======")])],1)],1)],1),t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[t(m.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",cuarto:"","darken-1":""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("medication")]),t("span",{staticClass:"title white--text"},[a._v("Farmacia / Transferencias")])],1),t(f.Cl),t(o.Z,{attrs:{fab:"",small:"",color:"primary darken-2"},on:{click:function(t){return a.retroceder()}}},[t(g.Z,[a._v("far fa-arrow-alt-circle-left")])],1)],1),t(s.Z,{staticClass:"elevation-6",attrs:{color:"grey lighten-2"}},[t(l.ZB,{staticClass:"px-0"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"","text-xs-center":""}},[t(m.Z,{attrs:{xs12:"","px-3":""}},[t(s.Z,{staticClass:"grey lighten-3"},[t(p.Z,{attrs:{"justify-center":"",row:"",wrap:""},on:{keypress:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.recargarDataTable(a.filtro)}}},[t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.desde,"background-color":"cuarto lighten-5",color:"cuarto",label:"Desde",icon:"today",max:a.filtro.hasta,requerido:"true"},model:{value:a.filtro.desde,callback:function(t){a.$set(a.filtro,"desde",t)},expression:"filtro.desde"}})],1),t(m.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:a.filtro.hasta,"background-color":"cuarto lighten-5",color:"cuarto",label:"Hasta",icon:"event",min:a.filtro.desde,requerido:"true"},model:{value:a.filtro.hasta,callback:function(t){a.$set(a.filtro,"hasta",t)},expression:"filtro.hasta"}})],1),t(m.Z,{attrs:{xs12:"",sm8:"","px-3":""}},[t(r.Z,{staticClass:"capitalizar",attrs:{clearable:"","background-color":"cuarto lighten-5","item-value":"id","item-text":"area",items:a.areasFiltro,label:"Farmacia","prepend-icon":"fa-house-medical-flag",color:"cuarto",multiple:"",chips:"","deletable-chips":""},on:{"click:clear":function(t){a.$nextTick((()=>a.filtro.areas=[]))}},model:{value:a.filtro.areas,callback:function(t){a.$set(a.filtro,"areas",t)},expression:"filtro.areas"}})],1)],1),t(l.h7,[t(f.Cl),t(o.Z,{staticClass:"white--text mb-2",attrs:{round:"",color:"cuarto darken-2",disabled:a.loading.estado,loading:a.loading.estado},on:{click:function(t){return a.recargarDataTable(a.filtro)}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("search")]),a._v(" Buscar Transferencias")],1),t(f.Cl)],1)],1)],1)],1)],1)],1)],1),t(m.Z,{attrs:{"pa-1":"","ma-1":"",xs12:"",cuarto:"","lighten-1":""}},[t(s.Z,{staticClass:"elevation-6"},[t(p.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",primary:""}},[t(m.Z,{attrs:{"px-3":""}},[t(g.Z,{attrs:{medium:"",color:"white",left:""}},[a._v("fa-solid fa-dolly")]),t("span",{staticClass:"title white--text"},[a._v("Transferencias de Insumos")])],1),t(f.Cl)],1),t(n.Z,[t(m.Z,{attrs:{xs12:"",sm4:"","px-2":""}},[t(b.h,{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":"",clearable:""},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1),t(f.Cl),t(u.Z,{staticClass:"hidden-xs-only mx-2 primary",attrs:{inset:"",vertical:""}}),t(o.Z,{staticClass:"mb-2",attrs:{round:"",color:"primary",disabled:a.loading.estado||!(a.persona.farmacia.gestion?.length>0||a.persona.farmacia.general?.admin),loading:a.loading.estado},on:{click:function(t){return a.actualizarDialogIngresoTransferencia({state:!0,type:{transferencia:!0}})}}},[t(g.Z,{attrs:{medium:"",left:""}},[a._v("input")]),a._v(" Nueva Transferencia")],1)],1),t(d.Z,{staticClass:"elevation-6",staticStyle:{"table-layout":"fixed"},attrs:{id:"tablita",headers:a.headers,items:a.dataTable,"item-key":"_id",pagination:a.paginacion,loading:a.loading.estado,search:a.search},on:{"update:pagination":function(t){a.paginacion=t}},scopedSlots:a._u([{key:"no-results",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(' No se encontraron resultados para "'+a._s(a.search)+'". ')])]},proxy:!0},{key:"no-data",fn:function(){return[t(i.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[a._v(" No hay datos para mostrar. ")])]},proxy:!0},{key:"items",fn:function(e){return[t("tr",{class:a.backgroundClass(e.item)},[t("td",{staticClass:"text-sm-left"},[t("div",{staticClass:"text-xs-center",staticStyle:{width:"90px"}},[t(v.Z,{attrs:{top:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:i}){return[t(o.Z,a._g({attrs:{disabled:a.noAdminNoGestion||a.loading.estado||e.item.recibido||e.item.remito&&!e.item.retirado||a.noAdminSiGestion&&!a.persona.farmacia.gestion.includes(e.item.destino),color:"white",small:"",icon:""},on:{click:function(t){return a.recibirIngreso({ingreso:{id:e.item._id,orden_compra:e.item.orden_compra,remito:e.item.remito},finish:a.recargarDataTable})}}},i),[t(g.Z,{attrs:{color:e.item.recibido?"green":"red"}},[a._v(a._s(e.item.recibido?"task_alt":"radio_button_unchecked"))])],1)]}}],null,!0)},[t("span",[a._v("Recibir")])]),t(v.Z,{attrs:{right:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:i}){return[t(o.Z,a._g({attrs:{disabled:a.noAdminNoGestion||a.loading.estado||e.item.retirado||a.noAdminSiGestion&&!a.persona.farmacia.gestion.includes(e.item.origen),color:"white",small:"",icon:""},on:{click:function(t){return a.retirarTransferencia({remito:e.item.remito,finish:a.recargarDataTable})}}},i),[t(g.Z,{attrs:{color:e.item.retirado?"green":"error"}},[a._v(a._s(e.item.retirado?"output":"check_box_outline_blank"))])],1)]}}],null,!0)},[t("span",[a._v("Retirar de Stock")])]),t(v.Z,{attrs:{bottom:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:i}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado,color:"white",small:"",icon:""},on:{click:function(t){return a.imprimirRemito({remito:e.item})}}},i),[t(g.Z,{attrs:{color:"green"}},[a._v("print")])],1)]}}],null,!0)},[t("span",[a._v("Ver PDF")])]),t(v.Z,{attrs:{right:"","close-delay":"0"},scopedSlots:a._u([{key:"activator",fn:function({on:i}){return[t(o.Z,a._g({attrs:{disabled:a.loading.estado,color:"white",small:"",icon:""},on:{click:function(t){return a.actualizarDialogIngresoTransferencia({state:!0,type:{transferencia:!0},ingreso:{remito:e.item},areasId:[e.item.origen,e.item.destino]})}}},i),[t(g.Z,{attrs:{color:"blue"}},[a._v("visibility")])],1)]}}],null,!0)},[t("span",[a._v("Ver Transferencia")])])],1)]),a._l(a.headersDinamics,(function(a){return t("td",{key:a.text,class:a.class},[t("bodyDataTableDinamic",{attrs:{props:e,field:a}})],1)}))],2)]}}])},[t(h.Z,{attrs:{color:"blue",indeterminate:""}})],1)],1)],1)],1),t("dialogTransferencia",{attrs:{closeFinish:a.recargarDataTable}})],1)},y=[],_=e(629),k=e(5967),Z=e(5167),E=e(8593),w={name:"farmaciaTransferenciaBuscar",components:{dateSelect:k.Z,bodyDataTableDinamic:Z.Z,dialogTransferencia:E.Z},data:()=>({areasFiltro:[],noAdminNoGestion:!1,noAdminSiGestion:!1,dataTable:[],filtro:{desde:(new Date).getFullYear()-1+"-"+((new Date).getMonth()+1).toString().padStart(2,0)+"-01",hasta:"",areas:[]},ultimoFiltro:{},search:"",paginacion:{sortBy:"remito",descending:!0,page:1,rowsPerPage:10},headers:[{text:"Acciones",value:"id",align:"center",sortable:!1,width:"5%",ignore:!0},{text:"Fecha",value:"fecha",align:"left",class:"text-xs-left",width:"15%",ruta:"fecha",date:!0},{text:"Transf. Origen",value:"origenDB",align:"left",class:"text-capitalize text-xs-left",width:"20%",ruta:"origenDB"},{text:"Destino",value:"destinoDB",align:"left",class:"text-capitalize text-xs-left",width:"20%",ruta:"destinoDB"},{text:"Remito Transf.",value:"remito",align:"left",class:"text-xs-right",width:"20%",ruta:"remito"},{text:"Fec. Planificada",value:"fec_planificada",align:"left",class:"text-xs-left",width:"10%",ruta:"fec_planificada",date:!0},{text:"Retirado Origen",value:"retirado",align:"left",class:"text-xs-left",width:"10%",ruta:"retirado",date:!0},{text:"Recibido Destino",value:"recibido",align:"left",class:"text-xs-left",width:"10%",ruta:"recibido",date:!0}]}),computed:{...(0,_.rn)(["loading","hoy","persona"]),headersDinamics(){return[...this.headers.filter((a=>!0!==a.ignore))]}},async created(){this.filtro.hasta=this.hoy,this.persona.farmacia.general?.admin||(this.persona.farmacia.gestion?this.noAdminSiGestion=!0:this.noAdminNoGestion=!0);let a=[...await this.buscarAreaFiltros({filtro:{farmacia:!0},populate:"no",select:"area"})];this.persona.farmacia.general?.reportes||this.persona.farmacia.general?.admin?(this.areasFiltro=a,this.filtro.areas=a.map((a=>a.id))):(this.areasFiltro=await this.filtrarArrayParaSelectsDisabled({arraySelects:a,arrayEnable:this.persona.farmacia.gestion,propCompare:"_id"}),this.filtro.areas=[...this.persona.farmacia.gestion]),await this.recargarDataTable(this.filtro)},methods:{...(0,_.nv)(["retroceder","filtrarArrayParaSelectsDisabled"]),...(0,_.nv)("main_areas",["buscarAreaFiltros"]),...(0,_.nv)("farmacia",["actualizarDialogIngresoTransferencia","buscarTransferenciasFiltro","recibirIngreso","retirarTransferencia","imprimirRemito"]),backgroundClass(a){if(!a)return"";try{return a.recibido?"background-color: green lighten-5":a.retirado?"background-color: blue lighten-4":"background-color: yellow lighten-4"}catch(t){return""}},async recargarDataTable(a){if(a){let t=await this.buscarTransferenciasFiltro(a);t&&(this.dataTable=t,this.ultimoFiltro=this._cloneDeep(a))}else this.dataTable=await this.buscarTransferenciasFiltro(this.ultimoFiltro)}}},D=w,C=e(1001),S=(0,C.Z)(D,x,y,!1,null,null,null),F=S.exports},445:function(a,t,e){e.d(t,{Z:function(){return r}});var i=e(21),r={name:"v-form",mixins:[(0,i.J)("form")],inheritAttrs:!1,props:{value:Boolean,lazyValidation:Boolean},data:function(){return{inputs:[],watchers:[],errorBag:{}}},watch:{errorBag:{handler:function(){var a=Object.values(this.errorBag).includes(!0);this.$emit("input",!a)},deep:!0,immediate:!0}},methods:{watchInput:function(a){var t=this,e=function(a){return a.$watch("hasError",(function(e){t.$set(t.errorBag,a._uid,e)}),{immediate:!0})},i={_uid:a._uid,valid:void 0,shouldValidate:void 0};return this.lazyValidation?i.shouldValidate=a.$watch("shouldValidate",(function(r){r&&(t.errorBag.hasOwnProperty(a._uid)||(i.valid=e(a)))})):i.valid=e(a),i},validate:function(){var a=this.inputs.filter((function(a){return!a.validate(!0)})).length;return!a},reset:function(){for(var a=this,t=this.inputs.length;t--;)this.inputs[t].reset();this.lazyValidation&&setTimeout((function(){a.errorBag={}}),0)},resetValidation:function(){for(var a=this,t=this.inputs.length;t--;)this.inputs[t].resetValidation();this.lazyValidation&&setTimeout((function(){a.errorBag={}}),0)},register:function(a){var t=this.watchInput(a);this.inputs.push(a),this.watchers.push(t)},unregister:function(a){var t=this.inputs.find((function(t){return t._uid===a._uid}));if(t){var e=this.watchers.find((function(a){return a._uid===t._uid}));e.valid&&e.valid(),e.shouldValidate&&e.shouldValidate(),this.watchers=this.watchers.filter((function(a){return a._uid!==t._uid})),this.inputs=this.inputs.filter((function(a){return a._uid!==t._uid})),this.$delete(this.errorBag,t._uid)}}},render:function(a){var t=this;return a("form",{staticClass:"v-form",attrs:Object.assign({novalidate:!0},this.$attrs),on:{submit:function(a){return t.$emit("submit",a)}}},this.$slots.default)}}}}]);