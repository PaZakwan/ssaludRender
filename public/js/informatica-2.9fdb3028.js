"use strict";(self["webpackChunksecretaria_de_salud_moreno_frontend"]=self["webpackChunksecretaria_de_salud_moreno_frontend"]||[]).push([[761],{5167:function(e,t,r){r.d(t,{Z:function(){return c}});var a=function(){var e=this,t=e._self._c;return e.field.array?t("span",[e.field.object?t("span",e._l(e._get(e.props.item,e.field.ruta),(function(r,a){return t("code",{key:`${e.field.text}-${a}`,attrs:{STYLE:"margin:4px"}},[e.field.keyShow?t("span",[e._v(e._s(e.field.date?e.mostrarFecha(r[e.field.keyShow],e.field.time):r[e.field.keyShow]||"0"==r[e.field.keyShow]?r[e.field.keyShow]:"S/D"))]):t("span",e._l(r,(function(o,i,s){return t("span",{key:`${e.field.text}-${a}-${i}`},[e._v(e._s(i)+": "),t("kbd",[e._v(e._s(isNaN(o)&&"Invalid Date"!==e.mostrarFecha(o,e.field.time)?e.mostrarFecha(o,e.field.time)||"S/D":o||"0"==o?o:"S/D"))]),s!=Object.keys(r).length-1?t("span",[e._v(e._s("\n"))]):e._e()])})),0)])})),0):t("span",e._l(e._get(e.props.item,e.field.ruta),(function(r,a){return t("code",{key:`${e.field.text}-${a}`,attrs:{STYLE:"margin:4px"}},[e._v(e._s(e.field.date?e.mostrarFecha(r,e.field.time):r||"0"==r?r:"S/D"))])})),0)]):e.field.object?t("span",[t("code",{attrs:{STYLE:"margin:4px"}},[e.field.keyShow?t("span",[e._v(e._s(e.field.date?e.mostrarFecha(e._get(e.props.item,e.field.ruta)[e.field.keyShow],e.field.time):e._get(e.props.item,e.field.ruta)[e.field.keyShow]||"0"==e._get(e.props.item,e.field.ruta)[e.field.keyShow]?e._get(e.props.item,e.field.ruta)[e.field.keyShow]:"--------"))]):t("span",e._l(e._get(e.props.item,e.field.ruta),(function(r,a,o){return t("span",{key:`${e.field.text}-${a}`},[e._v(e._s(a)+": "),t("kbd",[e._v(e._s(isNaN(r)&&"Invalid Date"!==e.mostrarFecha(r,e.field.time)?`${e.mostrarFecha(r,e.field.time)}`||"S/D":r||"0"==r?`${r}`:"S/D"))]),o!=Object.keys(e._get(e.props.item,e.field.ruta)).length-1?t("span",[e._v(e._s("\n"))]):e._e()])})),0)])]):t("span",{style:""+(e.field.numeric&&e._get(e.props.item,e.field.ruta)<0?"color: red;":"")},[e._v(e._s(e.field.date?e.mostrarFecha(e.props.item[e.field.ruta],e.field.time):e.field.boolean?""+(e._get(e.props.item,e.field.ruta)&&"false"!=e._get(e.props.item,e.field.ruta)&&"0"!=e._get(e.props.item,e.field.ruta)?"Si":"No"):e._get(e.props.item,e.field.ruta)||"0"==e._get(e.props.item,e.field.ruta)?e._get(e.props.item,e.field.ruta):"--------"))])},o=[],i={name:"body-data-table-dinamic",props:["props","field"]},s=i,n=r(1001),l=(0,n.Z)(s,a,o,!1,null,null,null),c=l.exports},5967:function(e,t,r){r.d(t,{Z:function(){return h}});var a=r(6961),o=r(683),i=r(9456),s=r(5084),n=r(4618),l=function(){var e=this,t=e._self._c;return t(i.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(o.Z,{attrs:{xs12:"","px-2":""}},[t(s.Z,{attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function({on:r}){return[t(n.h,e._g({attrs:{clearable:!e.soloLect&&!!e.clear,"background-color":e.soloLect?`${e.color} lighten-2`:`${e.color} lighten-5`,label:e.label,"prepend-icon":e.prepend,readonly:"",color:`${e.color} darken-3`,rules:e.req?e.validate:[]},on:{"click:clear":function(t){return e.$emit("input","")}},model:{value:e.fecha,callback:function(t){e.fecha=t},expression:"fecha"}},r))]}}]),model:{value:e.menufecha1,callback:function(t){e.menufecha1=t},expression:"menufecha1"}},[t(a.Z,{attrs:{readonly:e.soloLect,"allowed-dates":e.allowedDates,min:e.fecMin,max:e.fecMax,color:`${e.color} darken-3`,"header-color":`${e.color} darken-1`,locale:"mx"},on:{input:function(t){e.menufecha1=!1,e.$emit("input",t)}},model:{value:e.fecha,callback:function(t){e.fecha=t},expression:"fecha"}})],1)],1)],1)},c=[],d={name:"date-select",props:["value","label","icon","color","soloLectura","requerido","min","max","filtro","clearable"],data(){return{menufecha1:!1,validate:[e=>e?""===e.trim()?"Este campo es requerido.":!(e&&e.length<10)||"Ingrese fecha valida (AAAA-MM-DD).":"Este campo es requerido."]}},computed:{fecha:function(){return this.value},soloLect:function(){return this.soloLectura||!1},prepend:function(){return this.icon||"event"},req:function(){return this.requerido||!1},clear:function(){return this.clearable||!1},fecMin:function(){return"-1"===this.min?new Date((new Date).setFullYear((new Date).getFullYear()-1)).toISOString().substr(0,10):this.min?this.min:void 0},fecMax:function(){return"+1"===this.max?new Date((new Date).setFullYear((new Date).getFullYear()+1)).toISOString().substr(0,10):this.max?this.max:void 0},restriction:function(){return this.filtro||[]}},methods:{allowedDates:function(e){return!this.restriction.includes(new Date(e).getUTCDay())}}},u=d,m=r(1001),p=(0,m.Z)(u,l,c,!1,null,null,null),h=p.exports},4043:function(e,t,r){r.r(t),r.d(t,{default:function(){return j}});var a=r(7416),o=r(6194),i=r(8956),s=r(2353),n=r(6530),l=r(108),c=r(683),d=r(445),u=r(3667),m=r(9456),p=r(8143),h=r(4618),f=function(){var e=this,t=e._self._c;return t(n.Z,{attrs:{"grid-list-xs":""}},[t(m.Z,{attrs:{"align-center":"","justify-center":"","ma-0":"",wrap:"","text-xs-center":""}},[t(c.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(i.Z,{staticClass:"white--text",attrs:{color:"cuarto darken-2"}},[t(s.ZB,{staticClass:"px-0 text-uppercase"},[e._v("====== Patrimonio ======")])],1)],1),t(c.Z,{attrs:{"pa-1":"","ma-1":"",terciary:"",xs12:""}},[t(m.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",terciary:"","darken-2":""}},[t(c.Z,{attrs:{"px-3":""}},[t(u.Z,{attrs:{medium:"",color:"white",left:""}},[e._v("library_books")]),t("span",{staticClass:"title white--text"},[e._v(" Orden de Compra ")])],1),t(p.Cl),t(l.Z,{staticClass:"hidden-xs-only mx-2 my-1 white",attrs:{vertical:""}}),t(o.Z,{staticClass:"white--text",attrs:{round:"",color:"terciary darken-1",disabled:e.loading.estado,loading:e.loading.estado},on:{click:function(t){return e.$router.push({name:"PatrimonioBuscar"})}}},[t(u.Z,{attrs:{color:"white",left:""}},[e._v("search")]),e._v("Buscar Objetos")],1)],1),t(i.Z,{staticClass:"elevation-6"},[t(s.ZB,[t(d.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valido,callback:function(t){e.valido=t},expression:"valido"}},[t(m.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(c.Z,{attrs:{xs0:"",sm3:"","px-3":""}}),t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(h.h,{attrs:{"prepend-icon":"receipt",label:"Numero de Orden",type:"text",color:"terciary",clearable:"","background-color":"terciary lighten-5","validate-on-blur":"",rules:[...e.rules.requerido]},model:{value:e.nro_orden,callback:function(t){e.nro_orden=t},expression:"nro_orden"}})],1),t(c.Z,{attrs:{xs0:"",sm3:"","px-3":""}}),t(c.Z,{attrs:{xs12:"",sm6:"","px-2":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:e.fec_orden,color:"terciary",label:"Fecha de Orden",icon:"event",requerido:"true",clearable:"true"},model:{value:e.fec_orden,callback:function(t){e.fec_orden=t},expression:"fec_orden"}})],1),t(c.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(a.Z,{staticClass:"capitalizar",attrs:{rules:[...e.rules.requerido],clearable:"","item-value":"id","item-text":"area",items:e.areas,label:"Area","prepend-icon":"location_city",color:"terciary","background-color":"terciary lighten-5","validate-on-blur":""},model:{value:e.area_orden,callback:function(t){e.area_orden=t},expression:"area_orden"}})],1),t(c.Z,{attrs:{xs12:""}},[t(l.Z,{key:"ohyeah"})],1),e._l(e.orden,(function(r,i){return t(c.Z,{key:i,attrs:{xs12:"","px-3":""}},[t(m.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(c.Z,{attrs:{xs12:"",sm4:"","px-1":""}},[t(a.Z,{staticClass:"capitalizar",attrs:{rules:[...e.rules.requerido],clearable:"","item-value":"id","item-text":"modelo",items:e.objetosOrdenList,label:"Objeto Modelo","prepend-icon":"more",color:"terciary","background-color":"terciary lighten-5","validate-on-blur":""},model:{value:e.orden[i].id_objeto,callback:function(t){e.$set(e.orden[i],"id_objeto",t)},expression:"orden[index].id_objeto"}})],1),t(c.Z,{attrs:{xs12:"",sm4:"","px-1":""}},[t(h.h,{attrs:{rules:[...e.rules.requerido],clearable:"","prepend-icon":"description",label:"Motivo de Solicitud",type:"text",color:"terciary","background-color":"terciary lighten-5","validate-on-blur":""},model:{value:e.orden[i].motivo,callback:function(t){e.$set(e.orden[i],"motivo",t)},expression:"orden[index].motivo"}})],1),t(c.Z,{attrs:{xs12:"",sm3:"","px-1":""}},[t(h.h,{attrs:{clearable:"","background-color":"terciary lighten-5","prepend-icon":"grain",label:"Cantidad",type:"number",onkeydown:"return event.key !== 'e' && event.key !== 'E' && event.key !== '.' && event.key !== ',' && event.key !== '+' && event.key !== '-'",rules:[...e.rules.requerido,...e.rules.soloNumero,e.rules.minNumber(0)],color:"terciary"},model:{value:e.orden[i].cantidad,callback:function(t){e.$set(e.orden[i],"cantidad",t)},expression:"orden[index].cantidad"}})],1),0==i?t(o.Z,{attrs:{flat:"",icon:"",color:"blue lighten-2"},on:{click:function(t){return e.agregarFila()}}},[t(u.Z,[e._v("add_circle")])],1):e._e(),0!=i?t(o.Z,{attrs:{flat:"",icon:"",color:"red lighten-2"},on:{click:function(t){return e.borrarFila(i)}}},[t(u.Z,[e._v("delete_forever")])],1):e._e()],1),i+1<e.orden.length?t(l.Z,{key:`divider-${i}`}):e._e()],1)}))],2)],1)],1),t(m.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",terciary:"","lighten-2":""}},[t(o.Z,{staticClass:"terciary darken-1",attrs:{round:"",dark:"",disabled:e.loading.estado,loading:e.loading.estado},on:{click:function(t){return e.agregarFila()}}},[t(u.Z,{attrs:{left:""}},[e._v("add_circle")]),e._v("Agregar Objeto")],1),t(p.Cl),t(l.Z,{staticClass:"mx-2 my-1 white",attrs:{vertical:""}}),t(o.Z,{class:{"terciary darken-1":e.valido,"error darken-1":!e.valido},attrs:{round:"",dark:"",disabled:e.loading.estado,loading:e.loading.estado},on:{click:e.cambiarStock}},[e._v(" "+e._s(e.valido?"Cargar O.C.":"Formulario No valido"))])],1)],1)],1)],1)],1)},b=[],g=r(629),v=r(5967),_={name:"PatrimonioInsumosIngresos",components:{dateSelect:v.Z},data:()=>({valido:!0,areas:[],nro_orden:"",fec_orden:"",area_orden:"",orden:[{id_objeto:"",area_solicita:"",fec_solicitud:"",motivo:"Reposicion de Stock.",orden_compra:"",cantidad:"1",operacion:"suma"}],objetos:[]}),computed:{...(0,g.rn)(["APIURL","axiosConfig","loading","hoy","persona","rules"]),objetosOrdenList:function(){let e=[];return this.orden.forEach((t=>{t.id_objeto&&e.push(t.id_objeto)})),this.objetos.map((t=>({...t,disabled:e.includes(t._id)})))}},async created(){this.areas.push(...await this.buscarAreaFiltros({filtro:"todos",populate:"no",select:"area"})),this.cargarObjetos(),this.area_orden=this.persona.area,this.fec_orden=this.hoy},methods:{...(0,g.OI)(["mostrarLoading","ocultarLoading","mostrarError","mostrarMensaje"]),...(0,g.nv)("main_areas",["buscarAreaFiltros"]),async agregarFila(){this.orden.length<this.objetos.length&&this.orden.push({id_objeto:"",area_solicita:"",fec_solicitud:"",motivo:"Reposicion de Stock.",orden_compra:"",cantidad:"1",operacion:"suma"})},async borrarFila(e){this.orden.splice(e,1)},async cargarObjetos(){let e=JSON.stringify({categoria:"Insumos"});try{this.mostrarLoading({titulo:"Cargando datos...",color:"primary"});let r=await this.axios.get(`${this.APIURL}/patrimonio/buscar?filtro=${e}&select=modelo`,this.axiosConfig);if(r.data.ok)this.objetos=r.data.objetos;else try{this.mostrarError({errores:"",mensaje:r.data.err.message,titulo:r.status})}catch(t){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}}catch(t){try{this.mostrarError({errores:t.response.data.err.errors,mensaje:t.response.data.err.message,titulo:t.response.status})}catch(t){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}this.$router.push({name:"PatrimonioBuscar"})}finally{this.ocultarLoading()}},async cambiarStock(){if(this.$refs.form.validate()){let t=Object.assign([],this.orden);t.forEach((e=>{e.orden_compra=this.nro_orden,e.fec_solicitud=this.fec_orden,e.area_solicita=this.area_orden}));try{this.mostrarLoading({titulo:"Enviando datos...",color:"primary"});let r=await this.axios.post(this.APIURL+"/patrimonioOrdenCompra",t,this.axiosConfig);if(r.data.ok)this.mostrarMensaje({msj:["Orden de Compra cargada exitosamente.",`TOTAL Actualizados: ${r.data.data.totales.exitosos}.`,`TOTAL ERRORES: ${r.data.data.totales.errores}.`,`ERRORES: ${r.data.data.errores.split(".")}`],titulo:"Carga Exitosa"}),this.$router.push({name:"PatrimonioBuscar"});else try{this.mostrarError({errores:"",mensaje:r.data.err.message,titulo:r.status})}catch(e){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}}catch(e){try{this.mostrarError({errores:e.response.data.err.errors,mensaje:e.response.data.err.message,titulo:e.response.status})}catch(e){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}}finally{this.ocultarLoading()}}else this.mostrarError({errores:"",mensaje:"Revise los campos obligatorios.",titulo:"Valores Requeridos."})}}},y=_,x=r(1001),k=(0,x.Z)(y,f,b,!1,null,null,null),j=k.exports},805:function(e,t,r){r.r(t),r.d(t,{default:function(){return F}});var a=r(8469),o=r(6194),i=r(8956),s=r(2353),n=r(9418),l=r(6530),c=r(7352),d=r(108),u=r(683),m=r(445),p=r(3667),h=r(9456),f=r(6446),b=r(8143),g=r(4618),v=function(){var e=this,t=e._self._c;return t(l.Z,{attrs:{fluid:"","grid-list-xs":""}},[t(h.Z,{attrs:{"align-center":"","justify-center":"","ma-0":"",wrap:"","text-xs-center":""}},[t(u.Z,{attrs:{"pa-1":"","ma-1":"",cuarto:"",xs12:""}},[t(i.Z,{staticClass:"white--text",attrs:{color:"cuarto darken-2"}},[t(s.ZB,{staticClass:"px-0 text-uppercase"},[e._v("====== Patrimonio ======")])],1)],1),t(u.Z,{attrs:{"pa-1":"","ma-1":"",terciary:"",xs12:""}},[t(h.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",terciary:"","darken-2":""}},[t(u.Z,{attrs:{"text-xs-left":"","px-3":""}},[t(p.Z,{attrs:{medium:"",color:"white",left:""}},[e._v("library_books")]),t("span",{staticClass:"title white--text"},[e._v("Entrega de Stock - "+e._s(e.objeto.inventario?`Inventario: ${e.objeto.inventario}`:`Modelo: ${e.objeto.modelo}`))])],1),t(b.Cl),t(d.Z,{staticClass:"hidden-xs-only mx-2 my-1 white",attrs:{vertical:""}}),t(o.Z,{staticClass:"white--text",attrs:{round:"",to:{name:"PatrimonioBuscar"},color:"terciary darken-1",disabled:e.loading.estado,loading:e.loading.estado}},[e._v("Buscar Objetos")])],1),t(i.Z,{staticClass:"elevation-6"},[t(s.ZB,[t(m.Z,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valido,callback:function(t){e.valido=t},expression:"valido"}},[t("formInsumos",{attrs:{formulario:e.insumo,objeto:e.objeto,areas:e.areas}})],1)],1),t(h.Z,{attrs:{row:"",wrap:"","align-center":"","justify-center":"",terciary:"","lighten-2":""}},[t(b.Cl),t(d.Z,{staticClass:"hidden-xs-only mx-2 my-1 black",attrs:{vertical:""}}),t(o.Z,{class:{"terciary darken-1":e.valido,"error darken-1":!e.valido},attrs:{round:"",dark:"",disabled:e.loading.estado,loading:e.loading.estado},on:{click:e.cambiarStock}},[e._v(" "+e._s(e.valido?"Entregar Objeto":"Formulario No valido"))])],1)],1)],1),e.movimientos&&e.movimientos.length>0?t(h.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(u.Z,{attrs:{"pa-1":"","ma-2":"",terciary:"","lighten-1":"",xs12:""}},[t(n.Z,{staticClass:"title text-uppercase elevation-6"},[t(p.Z,{attrs:{color:"dark"}},[e._v("library_books")]),e._v(" Historial de Stock "),t(b.Cl),t(g.h,{attrs:{"append-icon":"search",label:"Filtrar","single-line":"",color:"terciary lighten-4","hide-details":"",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),t(c.Z,{staticClass:"elevation-6",staticStyle:{"table-layout":"fixed"},attrs:{id:"tablita",headers:e.headers,items:e.movimientos,"item-key":"_id",pagination:e.paginacion,loading:e.loading.estado,search:e.search},on:{"update:pagination":function(t){e.paginacion=t}},scopedSlots:e._u([{key:"no-data",fn:function(){return[t(a.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[e._v(" No hay datos para mostrar. ")])]},proxy:!0},{key:"no-results",fn:function(){return[t(a.Z,{staticClass:"text-sm-left",attrs:{value:!0,color:"error",icon:"warning"}},[e._v(' No se encontraron resultados para "'+e._s(e.search)+'". ')])]},proxy:!0},{key:"items",fn:function(r){return[t("tr",[t("td",{staticClass:"text-sm-right font-weight-bold",style:r.item.orden_compra?"":"color: red"},[e._v(" "+e._s(r.item.cantidad)+" ")]),e._l(e.headersDinamics,(function(e){return t("td",{key:e.text,class:e.class},[t("bodyDataTableDinamic",{attrs:{props:r,field:e}})],1)}))],2)]}}],null,!1,1337455172)},[t(f.Z,{attrs:{color:"blue",indeterminate:""}})],1)],1)],1):e._e()],1)],1)},_=[],y=r(629),x=r(5167),k=r(7416),j=r(5730),Z=function(){var e=this,t=e._self._c;return t("div",[t(h.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(u.Z,{attrs:{xs12:"",sm3:"","px-3":""}},[t(g.h,{staticClass:"input-text-align",staticStyle:{"--align":"center"},attrs:{readonly:"","background-color":("0"===e.objeto.cantidad||0===e.objeto.cantidad?"error":"terciary")+" lighten-1","prepend-icon":"grain",label:"Cantidad",type:"number",color:"terciary"},model:{value:e.objeto.cantidad,callback:function(t){e.$set(e.objeto,"cantidad",t)},expression:"objeto.cantidad"}})],1)],1),t(h.Z,{attrs:{"align-center":"","justify-center":"",row:"",wrap:""}},[t(u.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(k.Z,{staticClass:"capitalizar",attrs:{"item-value":"id","item-text":"area",clearable:"",items:e.areas,label:"Area Solicita","prepend-icon":"location_city",color:"terciary","background-color":"terciary lighten-5",rules:[...e.rules.requerido],"validate-on-blur":""},model:{value:e.formulario.area_solicita,callback:function(t){e.$set(e.formulario,"area_solicita",t)},expression:"formulario.area_solicita"}})],1),t(u.Z,{attrs:{xs12:"",sm6:"","px-2":""}},[t("dateSelect",{staticClass:"capitalizar",attrs:{value:e.formulario.fec_solicitud,color:"terciary",label:"Fecha de Solicitud",icon:"event",requerido:"true",clearable:"true"},model:{value:e.formulario.fec_solicitud,callback:function(t){e.$set(e.formulario,"fec_solicitud",t)},expression:"formulario.fec_solicitud"}})],1),t(u.Z,{attrs:{xs0:"",sm3:"","px-3":""}}),"Toner"===e.objeto.subcategoria?t(u.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(g.h,{attrs:{clearable:"","prepend-icon":"print",label:"Modelo de Impresora",type:"text",color:"terciary","background-color":"terciary lighten-5",rules:[...e.rules.requerido]},model:{value:e.formulario.modelo_impresora,callback:function(t){e.$set(e.formulario,"modelo_impresora",t)},expression:"formulario.modelo_impresora"}})],1):t(u.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(g.h,{attrs:{clearable:"","prepend-icon":"computer",label:"Nro. Inventario (Opcional)",type:"text",color:"terciary","background-color":"terciary lighten-5",hint:"Nro. Inventario al que se asociara el insumo (Opcional)","persistent-hint":""},model:{value:e.formulario.inventario_consume,callback:function(t){e.$set(e.formulario,"inventario_consume",t)},expression:"formulario.inventario_consume"}})],1),t(u.Z,{attrs:{xs0:"",sm3:"","px-3":""}}),t(u.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(g.h,{attrs:{clearable:"","prepend-icon":"person",label:"Apellido y Nombre(Solicitante)",type:"text",color:"terciary","background-color":"terciary lighten-5",rules:[...e.rules.requerido]},model:{value:e.formulario.persona_solicitante,callback:function(t){e.$set(e.formulario,"persona_solicitante",t)},expression:"formulario.persona_solicitante"}})],1),t(u.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(g.h,{attrs:{clearable:"","prepend-icon":"fas fa-id-card",label:"Legajo(Solicitante)",type:"text",color:"terciary","background-color":"terciary lighten-5",rules:[...e.rules.requerido]},model:{value:e.formulario.persona_legajo,callback:function(t){e.$set(e.formulario,"persona_legajo",t)},expression:"formulario.persona_legajo"}})],1),t(u.Z,{attrs:{xs12:"","mx-3":"","my-2":""}},[t(j.Z,{attrs:{clearable:"","background-color":"terciary lighten-5",label:"Motivo de la Solicitud",color:"terciary","prepend-icon":"description","auto-grow":"",rows:"2",rules:[...e.rules.requerido]},model:{value:e.formulario.motivo,callback:function(t){e.$set(e.formulario,"motivo",t)},expression:"formulario.motivo"}})],1),t(u.Z,{attrs:{xs12:"",sm6:"","px-3":""}},[t(g.h,{attrs:{clearable:"","background-color":"terciary lighten-5","prepend-icon":"grain",label:"Cantidad",type:"number",onkeydown:"return event.key !== 'e' && event.key !== 'E' && event.key !== '.' && event.key !== ',' && event.key !== '+' && event.key !== '-'",rules:e.positivoReqMenor,color:"terciary"},model:{value:e.formulario.cantidad,callback:function(t){e.$set(e.formulario,"cantidad",t)},expression:"formulario.cantidad"}})],1)],1)],1)},w=[],$=r(5967),C={name:"formInsumos",components:{dateSelect:$.Z},props:["formulario","objeto","areas"],data(){return{positivoReqMenor:[e=>{if(!e)return"Este campo es requerido.";if(isNaN(e))return"Debe ser un numero valido.";if(e&&this.objeto.cantidad){if(Number(e)<=0)return"El numero debe ser positivo.";if(Number(e)>Number(this.objeto.cantidad))return`El numero no debe superar la cantidad de Stock (${this.objeto.cantidad}).`}return!0}]}},computed:{...(0,y.rn)(["rules"])},created(){},methods:{}},S=C,E=r(1001),I=(0,E.Z)(S,Z,w,!1,null,null,null),O=I.exports,L={name:"patrimonioInsumos",components:{formInsumos:O,bodyDataTableDinamic:x.Z},data:()=>({valido:!0,areas:[],search:"",paginacion:{sortBy:"fec_solicitud",descending:!0,page:1,rowsPerPage:10},movimientos:[],insumo:{id_objeto:"",area_solicita:"",fec_solicitud:"",modelo_impresora:"",inventario_consume:"",persona_solicitante:"",persona_legajo:"",motivo:"Para consumo.",orden_compra:"",cantidad:1,operacion:"resta"},objeto:{_id:"",inventario:"",modelo:"",cantidad:"",subcategoria:"",compatibilidad:""}}),computed:{...(0,y.rn)(["APIURL","axiosConfig","loading","hoy"]),headers:function(){let e=[{text:"Cantidad",value:"cantidad",class:"text-sm-center",ruta:"cantidad",ignore:!0,date:!0},{text:"Fecha de Solicitud",value:"fec_solicitud",class:"text-sm-center",ruta:"fec_solicitud",date:!0},{text:"Area",value:"area_solicita.area",class:"text-sm-left text-capitalize",ruta:"area_solicita.area"},{text:"Motivo",value:"motivo",class:"text-sm-left",ruta:"motivo"}];return"Toner"===this.objeto.subcategoria?e.push({text:"Modelo de Impresora",value:"modelo_impresora",class:"text-sm-center",ruta:"modelo_impresora"}):e.push({text:"Nro. de inventario",value:"inventario_consume",class:"text-sm-center",ruta:"inventario_consume"}),e=[...e,{text:"Apellido y Nombre",value:"persona_solicitante",class:"text-sm-left text-capitalize",ruta:"persona_solicitante"},{text:"Nro. Legajo",value:"persona_legajo",class:"text-sm-right",ruta:"persona_legajo"},{text:"Orden de Compra",value:"orden_compra",class:"text-sm-right",ruta:"orden_compra"}],e},headersDinamics:function(){return this.headers.filter((e=>!0!==e.ignore))}},async created(){this.areas.push(...await this.buscarAreaFiltros({filtro:"todos",populate:"no",select:"area"})),this.insumo.id_objeto=this.$route.params.id,this.cargarObjeto(this.insumo.id_objeto),this.cargarMovimientos(this.insumo.id_objeto),this.insumo.fec_solicitud=this.hoy},methods:{...(0,y.OI)(["mostrarLoading","ocultarLoading","mostrarError","mostrarMensaje"]),...(0,y.nv)("main_areas",["buscarAreaFiltros"]),async cargarObjeto(e){try{this.mostrarLoading({titulo:"Cargando datos...",color:"primary"});let r=JSON.stringify({_id:e}),a=JSON.stringify({area:!1,usuario_eliminacion:!1,usuario_verifico:!1}),o=await this.axios.get(`${this.APIURL}/patrimonio/buscar?filtro=${r}&populate=${a}`,this.axiosConfig);if(o.data.ok)this.objeto["_id"]=o.data.objetos[0]["_id"],this.objeto["inventario"]=o.data.objetos[0]["inventario"],this.objeto["modelo"]=o.data.objetos[0]["modelo"],this.objeto["cantidad"]=o.data.objetos[0]["cantidad"],this.objeto["subcategoria"]=o.data.objetos[0]["subcategoria"],this.objeto["compatibilidad"]=o.data.objetos[0]["compatibilidad"];else try{this.mostrarError({errores:"",mensaje:o.data.err.message,titulo:o.status})}catch(t){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}}catch(r){try{this.mostrarError({errores:r.response.data.err.errors,mensaje:r.response.data.err.message,titulo:r.response.status})}catch(a){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}this.$router.push({name:"PatrimonioBuscar"})}finally{this.ocultarLoading()}},async cargarMovimientos(e){try{this.mostrarLoading({titulo:"Cargando datos...",color:"primary"});let r=await this.axios.get(this.APIURL+"/patrimonioStock/buscar?obj="+e,this.axiosConfig);if(r.data.ok)this.movimientos=Object.assign([],r.data.movimientos);else try{this.mostrarError({errores:"",mensaje:r.data.err.message,titulo:r.status})}catch(t){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}}catch(t){try{this.mostrarError({errores:t.response.data.err.errors,mensaje:t.response.data.err.message,titulo:t.response.status})}catch(t){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}this.$router.push({name:"PatrimonioBuscar"})}finally{this.ocultarLoading()}},async cambiarStock(){if(this.$refs.form.validate()){let t=Object.assign({},this.insumo);try{this.mostrarLoading({titulo:"Enviando datos...",color:"primary"});let r=await this.axios.post(this.APIURL+"/patrimonioStock",t,this.axiosConfig);if(r.data.ok)this.objeto.inventario?this.mostrarMensaje({msj:[`Cantidad: ${t.cantidad} entregado/s exitosamente.`,"<##> Nº Inventario: "+this.objeto.inventario.toString()+"<##>"],titulo:"Entrega Exitosa"}):this.mostrarMensaje({msj:[`Cantidad: ${t.cantidad} entregado/s exitosamente.`],titulo:`${this.objeto.modelo}`}),this.$router.push({name:"PatrimonioBuscar"});else try{this.mostrarError({errores:"",mensaje:r.data.err.message,titulo:r.status})}catch(e){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}}catch(e){try{this.mostrarError({errores:e.response.data.err.errors,mensaje:e.response.data.err.message,titulo:e.response.status})}catch(e){this.mostrarError({errores:"",mensaje:"Problemas con el servidor, Intente mas tarde.",titulo:500})}}finally{this.ocultarLoading()}}else this.mostrarError({errores:"",mensaje:"Revise los campos obligatorios.",titulo:"Valores Requeridos."})}}},P=L,D=(0,E.Z)(P,v,_,!1,null,null,null),F=D.exports},445:function(e,t,r){r.d(t,{Z:function(){return o}});var a=r(21),o={name:"v-form",mixins:[(0,a.J)("form")],inheritAttrs:!1,props:{value:Boolean,lazyValidation:Boolean},data:function(){return{inputs:[],watchers:[],errorBag:{}}},watch:{errorBag:{handler:function(){var e=Object.values(this.errorBag).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput:function(e){var t=this,r=function(e){return e.$watch("hasError",(function(r){t.$set(t.errorBag,e._uid,r)}),{immediate:!0})},a={_uid:e._uid,valid:void 0,shouldValidate:void 0};return this.lazyValidation?a.shouldValidate=e.$watch("shouldValidate",(function(o){o&&(t.errorBag.hasOwnProperty(e._uid)||(a.valid=r(e)))})):a.valid=r(e),a},validate:function(){var e=this.inputs.filter((function(e){return!e.validate(!0)})).length;return!e},reset:function(){for(var e=this,t=this.inputs.length;t--;)this.inputs[t].reset();this.lazyValidation&&setTimeout((function(){e.errorBag={}}),0)},resetValidation:function(){for(var e=this,t=this.inputs.length;t--;)this.inputs[t].resetValidation();this.lazyValidation&&setTimeout((function(){e.errorBag={}}),0)},register:function(e){var t=this.watchInput(e);this.inputs.push(e),this.watchers.push(t)},unregister:function(e){var t=this.inputs.find((function(t){return t._uid===e._uid}));if(t){var r=this.watchers.find((function(e){return e._uid===t._uid}));r.valid&&r.valid(),r.shouldValidate&&r.shouldValidate(),this.watchers=this.watchers.filter((function(e){return e._uid!==t._uid})),this.inputs=this.inputs.filter((function(e){return e._uid!==t._uid})),this.$delete(this.errorBag,t._uid)}}},render:function(e){var t=this;return e("form",{staticClass:"v-form",attrs:Object.assign({novalidate:!0},this.$attrs),on:{submit:function(e){return t.$emit("submit",e)}}},this.$slots.default)}}}}]);